var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function r(t){t.forEach(n)}function i(t){return"function"==typeof t}function o(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function a(t,n){t.appendChild(n)}function u(t,n,e){t.insertBefore(n,e||null)}function l(t){t.parentNode.removeChild(t)}function s(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function c(t){return document.createElement(t)}function f(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function h(t){return document.createTextNode(t)}function p(){return h(" ")}function d(){return h("")}function g(t,n,e,r){return t.addEventListener(n,e,r),()=>t.removeEventListener(n,e,r)}function v(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function m(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}function y(t,n){t.value=null==n?"":n}function _(t,n,e,r){t.style.setProperty(n,e,r?"important":"")}let w;function x(t){w=t}function b(t){(function(){if(!w)throw new Error("Function called outside component initialization");return w})().$$.on_mount.push(t)}const M=[],k=[],A=[],S=[],T=Promise.resolve();let E=!1;function N(t){A.push(t)}let C=!1;const z=new Set;function D(){if(!C){C=!0;do{for(let t=0;t<M.length;t+=1){const n=M[t];x(n),Y(n.$$)}for(x(null),M.length=0;k.length;)k.pop()();for(let t=0;t<A.length;t+=1){const n=A[t];z.has(n)||(z.add(n),n())}A.length=0}while(M.length);for(;S.length;)S.pop()();E=!1,C=!1,z.clear()}}function Y(t){if(null!==t.fragment){t.update(),r(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(N)}}const F=new Set;let L;function j(){L={r:0,c:[],p:L}}function $(){L.r||r(L.c),L=L.p}function I(t,n){t&&t.i&&(F.delete(t),t.i(n))}function U(t,n,e,r){if(t&&t.o){if(F.has(t))return;F.add(t),L.c.push((()=>{F.delete(t),r&&(e&&t.d(1),r())})),t.o(n)}}function H(t){t&&t.c()}function O(t,e,o){const{fragment:a,on_mount:u,on_destroy:l,after_update:s}=t.$$;a&&a.m(e,o),N((()=>{const e=u.map(n).filter(i);l?l.push(...e):r(e),t.$$.on_mount=[]})),s.forEach(N)}function q(t,n){const e=t.$$;null!==e.fragment&&(r(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function P(t,n){-1===t.$$.dirty[0]&&(M.push(t),E||(E=!0,T.then(D)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function V(n,i,o,a,u,s,c=[-1]){const f=w;x(n);const h=i.props||{},p=n.$$={fragment:null,ctx:null,props:s,update:t,not_equal:u,bound:e(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:e(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=o?o(n,h,((t,e,...r)=>{const i=r.length?r[0]:e;return p.ctx&&u(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),d&&P(n,t)),e})):[],p.update(),d=!0,r(p.before_update),p.fragment=!!a&&a(p.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);p.fragment&&p.fragment.l(t),t.forEach(l)}else p.fragment&&p.fragment.c();i.intro&&I(n.$$.fragment),O(n,i.target,i.anchor),D()}x(f)}class B{$destroy(){q(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function R(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function X(t){let n=t,e=t;function r(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;e(t[o],n)<0?r=o+1:i=o}return r}return 1===t.length&&(n=(n,e)=>t(n)-e,e=function(t){return(n,e)=>R(t(n),e)}(t)),{left:r,center:function(t,e,i,o){null==i&&(i=0),null==o&&(o=t.length);const a=r(t,e,i,o-1);return a>i&&n(t[a-1],e)>-n(t[a],e)?a-1:a},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;e(t[o],n)>0?i=o:r=o+1}return r}}}const G=X(R).right;X((function(t){return null===t?NaN:+t})).center;function W(t,n){let e,r;if(void 0===n)for(const n of t)null!=n&&(void 0===e?n>=n&&(e=r=n):(e>n&&(e=n),r<n&&(r=n)));else{let i=-1;for(let o of t)null!=(o=n(o,++i,t))&&(void 0===e?o>=o&&(e=r=o):(e>o&&(e=o),r<o&&(r=o)))}return[e,r]}class Z{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const i=n[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(n[e++]=a),t=o}return n[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let n,e,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(n=o,e=t[--i],o=n+e,r=e-(o-n),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(e=2*r,n=o+e,e==n-o&&(o=n))}return o}}var K=Math.sqrt(50),J=Math.sqrt(10),Q=Math.sqrt(2);function tt(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=K?10:o>=J?5:o>=Q?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=K?10:o>=J?5:o>=Q?2:1)}function nt(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=K?i*=10:o>=J?i*=5:o>=Q&&(i*=2),n<t?-i:i}function et(t,n){let e;if(void 0===n)for(const n of t)null!=n&&(e<n||void 0===e&&n>=n)&&(e=n);else{let r=-1;for(let i of t)null!=(i=n(i,++r,t))&&(e<i||void 0===e&&i>=i)&&(e=i)}return e}function rt(t,n){let e;if(void 0===n)for(const n of t)null!=n&&(e>n||void 0===e&&n>=n)&&(e=n);else{let r=-1;for(let i of t)null!=(i=n(i,++r,t))&&(e>i||void 0===e&&i>=i)&&(e=i)}return e}function it(t){return Array.from(function*(t){for(const n of t)yield*n}(t))}function ot(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=0|Math.max(0,Math.ceil((n-t)/e)),o=new Array(i);++r<i;)o[r]=t+r*e;return o}var at=Array.prototype.slice;function ut(t){return t}var lt=1e-6;function st(t){return"translate("+(t+.5)+",0)"}function ct(t){return"translate(0,"+(t+.5)+")"}function ft(t){return n=>+t(n)}function ht(t){var n=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(n=Math.round(n)),function(e){return+t(e)+n}}function pt(){return!this.__axis}function dt(t,n){var e=[],r=null,i=null,o=6,a=6,u=3,l=1===t||4===t?-1:1,s=4===t||2===t?"x":"y",c=1===t||3===t?st:ct;function f(f){var h=null==r?n.ticks?n.ticks.apply(n,e):n.domain():r,p=null==i?n.tickFormat?n.tickFormat.apply(n,e):ut:i,d=Math.max(o,0)+u,g=n.range(),v=+g[0]+.5,m=+g[g.length-1]+.5,y=(n.bandwidth?ht:ft)(n.copy()),_=f.selection?f.selection():f,w=_.selectAll(".domain").data([null]),x=_.selectAll(".tick").data(h,n).order(),b=x.exit(),M=x.enter().append("g").attr("class","tick"),k=x.select("line"),A=x.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(M),k=k.merge(M.append("line").attr("stroke","currentColor").attr(s+"2",l*o)),A=A.merge(M.append("text").attr("fill","currentColor").attr(s,l*d).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),f!==_&&(w=w.transition(f),x=x.transition(f),k=k.transition(f),A=A.transition(f),b=b.transition(f).attr("opacity",lt).attr("transform",(function(t){return isFinite(t=y(t))?c(t):this.getAttribute("transform")})),M.attr("opacity",lt).attr("transform",(function(t){var n=this.parentNode.__axis;return c(n&&isFinite(n=n(t))?n:y(t))}))),b.remove(),w.attr("d",4===t||2==t?a?"M"+l*a+","+v+"H0.5V"+m+"H"+l*a:"M0.5,"+v+"V"+m:a?"M"+v+","+l*a+"V0.5H"+m+"V"+l*a:"M"+v+",0.5H"+m),x.attr("opacity",1).attr("transform",(function(t){return c(y(t))})),k.attr(s+"2",l*o),A.attr(s,l*d).text(p),_.filter(pt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),_.each((function(){this.__axis=y}))}return f.scale=function(t){return arguments.length?(n=t,f):n},f.ticks=function(){return e=at.call(arguments),f},f.tickArguments=function(t){return arguments.length?(e=null==t?[]:at.call(t),f):e.slice()},f.tickValues=function(t){return arguments.length?(r=null==t?null:at.call(t),f):r&&r.slice()},f.tickFormat=function(t){return arguments.length?(i=t,f):i},f.tickSize=function(t){return arguments.length?(o=a=+t,f):o},f.tickSizeInner=function(t){return arguments.length?(o=+t,f):o},f.tickSizeOuter=function(t){return arguments.length?(a=+t,f):a},f.tickPadding=function(t){return arguments.length?(u=+t,f):u},f}function gt(t){return dt(3,t)}function vt(t){return dt(4,t)}var mt={value:()=>{}};function yt(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new _t(r)}function _t(t){this._=t}function wt(t,n){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))}function xt(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function bt(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=mt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}_t.prototype=yt.prototype={constructor:_t,on:function(t,n){var e,r=this._,i=wt(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++o<a;)if(e=(t=i[o]).type)r[e]=bt(r[e],t.name,n);else if(null==n)for(e in r)r[e]=bt(r[e],t.name,null);return this}for(;++o<a;)if((e=(t=i[o]).type)&&(e=xt(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new _t(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),o=0;o<e;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(r=this._[t]).length;o<e;++o)r[o].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};var Mt="http://www.w3.org/1999/xhtml",kt={svg:"http://www.w3.org/2000/svg",xhtml:Mt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function At(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),kt.hasOwnProperty(n)?{space:kt[n],local:t}:t}function St(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===Mt&&n.documentElement.namespaceURI===Mt?n.createElement(t):n.createElementNS(e,t)}}function Tt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Et(t){var n=At(t);return(n.local?Tt:St)(n)}function Nt(){}function Ct(t){return null==t?Nt:function(){return this.querySelector(t)}}function zt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Dt(){return[]}function Yt(t){return null==t?Dt:function(){return this.querySelectorAll(t)}}function Ft(t){return function(){return this.matches(t)}}function Lt(t){return function(n){return n.matches(t)}}var jt=Array.prototype.find;function $t(){return this.firstElementChild}var It=Array.prototype.filter;function Ut(){return this.children}function Ht(t){return new Array(t.length)}function Ot(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function qt(t){return function(){return t}}function Pt(t,n,e,r,i,o){for(var a,u=0,l=n.length,s=o.length;u<s;++u)(a=n[u])?(a.__data__=o[u],r[u]=a):e[u]=new Ot(t,o[u]);for(;u<l;++u)(a=n[u])&&(i[u]=a)}function Vt(t,n,e,r,i,o,a){var u,l,s,c=new Map,f=n.length,h=o.length,p=new Array(f);for(u=0;u<f;++u)(l=n[u])&&(p[u]=s=a.call(l,l.__data__,u,n)+"",c.has(s)?i[u]=l:c.set(s,l));for(u=0;u<h;++u)s=a.call(t,o[u],u,o)+"",(l=c.get(s))?(r[u]=l,l.__data__=o[u],c.delete(s)):e[u]=new Ot(t,o[u]);for(u=0;u<f;++u)(l=n[u])&&c.get(p[u])===l&&(i[u]=l)}function Bt(t){return t.__data__}function Rt(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function Xt(t){return function(){this.removeAttribute(t)}}function Gt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Wt(t,n){return function(){this.setAttribute(t,n)}}function Zt(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function Kt(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function Jt(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function Qt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function tn(t){return function(){this.style.removeProperty(t)}}function nn(t,n,e){return function(){this.style.setProperty(t,n,e)}}function en(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function rn(t,n){return t.style.getPropertyValue(n)||Qt(t).getComputedStyle(t,null).getPropertyValue(n)}function on(t){return function(){delete this[t]}}function an(t,n){return function(){this[t]=n}}function un(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function ln(t){return t.trim().split(/^|\s+/)}function sn(t){return t.classList||new cn(t)}function cn(t){this._node=t,this._names=ln(t.getAttribute("class")||"")}function fn(t,n){for(var e=sn(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function hn(t,n){for(var e=sn(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function pn(t){return function(){fn(this,t)}}function dn(t){return function(){hn(this,t)}}function gn(t,n){return function(){(n.apply(this,arguments)?fn:hn)(this,t)}}function vn(){this.textContent=""}function mn(t){return function(){this.textContent=t}}function yn(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function _n(){this.innerHTML=""}function wn(t){return function(){this.innerHTML=t}}function xn(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function bn(){this.nextSibling&&this.parentNode.appendChild(this)}function Mn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function kn(){return null}function An(){var t=this.parentNode;t&&t.removeChild(this)}function Sn(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Tn(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function En(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function Nn(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.options);++i?n.length=i:delete this.__on}}}function Cn(t,n,e){return function(){var r,i=this.__on,o=function(t){return function(n){t.call(this,n,this.__data__)}}(n);if(i)for(var a=0,u=i.length;a<u;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),void(r.value=n);this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},i?i.push(r):this.__on=[r]}}function zn(t,n,e){var r=Qt(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function Dn(t,n){return function(){return zn(this,t,n)}}function Yn(t,n){return function(){return zn(this,t,n.apply(this,arguments))}}Ot.prototype={constructor:Ot,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},cn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Fn=[null];function Ln(t,n){this._groups=t,this._parents=n}function jn(){return new Ln([[document.documentElement]],Fn)}function $n(t){return"string"==typeof t?new Ln([[document.querySelector(t)]],[document.documentElement]):new Ln([[t]],Fn)}function In(t,n){if(t=function(t){let n;for(;n=t.sourceEvent;)t=n;return t}(t),void 0===n&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(n.getScreenCTM().inverse())).x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}}return[t.pageX,t.pageY]}function Un(t){return"string"==typeof t?new Ln([document.querySelectorAll(t)],[document.documentElement]):new Ln([null==t?[]:zt(t)],Fn)}function Hn(t){t.stopImmediatePropagation()}function On(t){t.preventDefault(),t.stopImmediatePropagation()}function qn(t){var n=t.document.documentElement,e=$n(t).on("dragstart.drag",On,!0);"onselectstart"in n?e.on("selectstart.drag",On,!0):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Pn(t,n){var e=t.document.documentElement,r=$n(t).on("dragstart.drag",null);n&&(r.on("click.drag",On,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}Ln.prototype=jn.prototype={constructor:Ln,select:function(t){"function"!=typeof t&&(t=Ct(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a,u=n[i],l=u.length,s=r[i]=new Array(l),c=0;c<l;++c)(o=u[c])&&(a=t.call(o,o.__data__,c,u))&&("__data__"in o&&(a.__data__=o.__data__),s[c]=a);return new Ln(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var n=t.apply(this,arguments);return null==n?[]:zt(n)}}(t):Yt(t);for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a,u=n[o],l=u.length,s=0;s<l;++s)(a=u[s])&&(r.push(t.call(a,a.__data__,s,u)),i.push(a));return new Ln(r,i)},selectChild:function(t){return this.select(null==t?$t:function(t){return function(){return jt.call(this.children,t)}}("function"==typeof t?t:Lt(t)))},selectChildren:function(t){return this.selectAll(null==t?Ut:function(t){return function(){return It.call(this.children,t)}}("function"==typeof t?t:Lt(t)))},filter:function(t){"function"!=typeof t&&(t=Ft(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,l=r[i]=[],s=0;s<u;++s)(o=a[s])&&t.call(o,o.__data__,s,a)&&l.push(o);return new Ln(r,this._parents)},data:function(t,n){if(!arguments.length)return Array.from(this,Bt);var e=n?Vt:Pt,r=this._parents,i=this._groups;"function"!=typeof t&&(t=qt(t));for(var o=i.length,a=new Array(o),u=new Array(o),l=new Array(o),s=0;s<o;++s){var c=r[s],f=i[s],h=f.length,p=zt(t.call(c,c&&c.__data__,s,r)),d=p.length,g=u[s]=new Array(d),v=a[s]=new Array(d),m=l[s]=new Array(h);e(c,f,g,v,m,p,n);for(var y,_,w=0,x=0;w<d;++w)if(y=g[w]){for(w>=x&&(x=w+1);!(_=v[x])&&++x<d;);y._next=_||null}}return(a=new Ln(a,r))._enter=u,a._exit=l,a},enter:function(){return new Ln(this._enter||this._groups.map(Ht),this._parents)},exit:function(){return new Ln(this._exit||this._groups.map(Ht),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=n&&(i=n(i)),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){if(!(t instanceof Ln))throw new Error("invalid merge");for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var l,s=n[u],c=e[u],f=s.length,h=a[u]=new Array(f),p=0;p<f;++p)(l=s[p]||c[p])&&(h[p]=l);for(;u<r;++u)a[u]=n[u];return new Ln(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=Rt);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,u=e[o],l=u.length,s=i[o]=new Array(l),c=0;c<l;++c)(a=u[c])&&(s[c]=a);s.sort(n)}return new Ln(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const n of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=At(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?Gt:Xt:"function"==typeof n?e.local?Jt:Kt:e.local?Zt:Wt)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?tn:"function"==typeof n?en:nn)(t,n,null==e?"":e)):rn(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?on:"function"==typeof n?un:an)(t,n)):this.node()[t]},classed:function(t,n){var e=ln(t+"");if(arguments.length<2){for(var r=sn(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?gn:n?pn:dn)(e,n))},text:function(t){return arguments.length?this.each(null==t?vn:("function"==typeof t?yn:mn)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?_n:("function"==typeof t?xn:wn)(t)):this.node().innerHTML},raise:function(){return this.each(bn)},lower:function(){return this.each(Mn)},append:function(t){var n="function"==typeof t?t:Et(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:Et(t),r=null==n?kn:"function"==typeof n?n:Ct(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(An)},clone:function(t){return this.select(t?Tn:Sn)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=En(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?Cn:Nn,r=0;r<a;++r)this.each(u(o[r],n,e));return this}var u=this.node().__on;if(u)for(var l,s=0,c=u.length;s<c;++s)for(r=0,l=u[s];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,n){return this.each(("function"==typeof n?Yn:Dn)(t,n))},[Symbol.iterator]:function*(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r,i=t[n],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};var Vn=t=>()=>t;function Bn(t,{sourceEvent:n,subject:e,target:r,identifier:i,active:o,x:a,y:u,dx:l,dy:s,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:s,enumerable:!0,configurable:!0},_:{value:c}})}function Rn(t){return!t.ctrlKey&&!t.button}function Xn(){return this.parentNode}function Gn(t,n){return null==n?{x:t.x,y:t.y}:n}function Wn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zn(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Kn(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Jn(){}Bn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Qn=.7,te=1/Qn,ne="\\s*([+-]?\\d+)\\s*",ee="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",re="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ie=/^#([0-9a-f]{3,8})$/,oe=new RegExp("^rgb\\("+[ne,ne,ne]+"\\)$"),ae=new RegExp("^rgb\\("+[re,re,re]+"\\)$"),ue=new RegExp("^rgba\\("+[ne,ne,ne,ee]+"\\)$"),le=new RegExp("^rgba\\("+[re,re,re,ee]+"\\)$"),se=new RegExp("^hsl\\("+[ee,re,re]+"\\)$"),ce=new RegExp("^hsla\\("+[ee,re,re,ee]+"\\)$"),fe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function he(){return this.rgb().formatHex()}function pe(){return this.rgb().formatRgb()}function de(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=ie.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?ge(n):3===e?new _e(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?ve(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?ve(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=oe.exec(t))?new _e(n[1],n[2],n[3],1):(n=ae.exec(t))?new _e(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=ue.exec(t))?ve(n[1],n[2],n[3],n[4]):(n=le.exec(t))?ve(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=se.exec(t))?Me(n[1],n[2]/100,n[3]/100,1):(n=ce.exec(t))?Me(n[1],n[2]/100,n[3]/100,n[4]):fe.hasOwnProperty(t)?ge(fe[t]):"transparent"===t?new _e(NaN,NaN,NaN,0):null}function ge(t){return new _e(t>>16&255,t>>8&255,255&t,1)}function ve(t,n,e,r){return r<=0&&(t=n=e=NaN),new _e(t,n,e,r)}function me(t){return t instanceof Jn||(t=de(t)),t?new _e((t=t.rgb()).r,t.g,t.b,t.opacity):new _e}function ye(t,n,e,r){return 1===arguments.length?me(t):new _e(t,n,e,null==r?1:r)}function _e(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function we(){return"#"+be(this.r)+be(this.g)+be(this.b)}function xe(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function be(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Me(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new Ae(t,n,e,r)}function ke(t){if(t instanceof Ae)return new Ae(t.h,t.s,t.l,t.opacity);if(t instanceof Jn||(t=de(t)),!t)return new Ae;if(t instanceof Ae)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,u=o-i,l=(o+i)/2;return u?(a=n===o?(e-r)/u+6*(e<r):e===o?(r-n)/u+2:(n-e)/u+4,u/=l<.5?o+i:2-o-i,a*=60):u=l>0&&l<1?0:a,new Ae(a,u,l,t.opacity)}function Ae(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Se(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}Zn(Jn,de,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:he,formatHex:he,formatHsl:function(){return ke(this).formatHsl()},formatRgb:pe,toString:pe}),Zn(_e,ye,Kn(Jn,{brighter:function(t){return t=null==t?te:Math.pow(te,t),new _e(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Qn:Math.pow(Qn,t),new _e(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:we,formatHex:we,formatRgb:xe,toString:xe})),Zn(Ae,(function(t,n,e,r){return 1===arguments.length?ke(t):new Ae(t,n,e,null==r?1:r)}),Kn(Jn,{brighter:function(t){return t=null==t?te:Math.pow(te,t),new Ae(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Qn:Math.pow(Qn,t),new Ae(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new _e(Se(t>=240?t-240:t+120,i,r),Se(t,i,r),Se(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Te=t=>()=>t;function Ee(t){return 1==(t=+t)?Ne:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):Te(isNaN(n)?e:n)}}function Ne(t,n){var e=n-t;return e?function(t,n){return function(e){return t+e*n}}(t,e):Te(isNaN(t)?n:t)}var Ce=function t(n){var e=Ee(n);function r(t,n){var r=e((t=ye(t)).r,(n=ye(n)).r),i=e(t.g,n.g),o=e(t.b,n.b),a=Ne(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=o(n),t.opacity=a(n),t+""}}return r.gamma=t,r}(1);function ze(t,n){n||(n=[]);var e,r=t?Math.min(n.length,t.length):0,i=n.slice();return function(o){for(e=0;e<r;++e)i[e]=t[e]*(1-o)+n[e]*o;return i}}function De(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(e=0;e<i;++e)o[e]=Ue(t[e],n[e]);for(;e<r;++e)a[e]=n[e];return function(t){for(e=0;e<i;++e)a[e]=o[e](t);return a}}function Ye(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function Fe(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function Le(t,n){var e,r={},i={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?r[e]=Ue(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}}var je=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$e=new RegExp(je.source,"g");function Ie(t,n){var e,r,i,o=je.lastIndex=$e.lastIndex=0,a=-1,u=[],l=[];for(t+="",n+="";(e=je.exec(t))&&(r=$e.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(e=e[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,l.push({i:a,x:Fe(e,r)})),o=$e.lastIndex;return o<n.length&&(i=n.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?l[0]?function(t){return function(n){return t(n)+""}}(l[0].x):function(t){return function(){return t}}(n):(n=l.length,function(t){for(var e,r=0;r<n;++r)u[(e=l[r]).i]=e.x(t);return u.join("")})}function Ue(t,n){var e,r=typeof n;return null==n||"boolean"===r?Te(n):("number"===r?Fe:"string"===r?(e=de(n))?(n=e,Ce):Ie:n instanceof de?Ce:n instanceof Date?Ye:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(n)?ze:Array.isArray(n)?De:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?Le:Fe)(t,n)}function He(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}var Oe,qe=180/Math.PI,Pe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ve(t,n,e,r,i,o){var a,u,l;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(l=t*e+n*r)&&(e-=t*l,r-=n*l),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,l/=u),t*r<n*e&&(t=-t,n=-n,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*qe,skewX:Math.atan(l)*qe,scaleX:a,scaleY:u}}function Be(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var u=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,u){if(t!==i||r!==o){var l=a.push("translate(",null,n,null,e);u.push({i:l-4,x:Fe(t,i)},{i:l-2,x:Fe(r,o)})}else(i||o)&&a.push("translate("+i+n+o+e)}(o.translateX,o.translateY,a.translateX,a.translateY,u,l),function(t,n,e,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:e.push(i(e)+"rotate(",null,r)-2,x:Fe(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(o.rotate,a.rotate,u,l),function(t,n,e,o){t!==n?o.push({i:e.push(i(e)+"skewX(",null,r)-2,x:Fe(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(o.skewX,a.skewX,u,l),function(t,n,e,r,o,a){if(t!==e||n!==r){var u=o.push(i(o)+"scale(",null,",",null,")");a.push({i:u-4,x:Fe(t,e)},{i:u-2,x:Fe(n,r)})}else 1===e&&1===r||o.push(i(o)+"scale("+e+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,u,l),o=a=null,function(t){for(var n,e=-1,r=l.length;++e<r;)u[(n=l[e]).i]=n.x(t);return u.join("")}}}var Re=Be((function(t){const n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Pe:Ve(n.a,n.b,n.c,n.d,n.e,n.f)}),"px, ","px)","deg)"),Xe=Be((function(t){return null==t?Pe:(Oe||(Oe=document.createElementNS("http://www.w3.org/2000/svg","g")),Oe.setAttribute("transform",t),(t=Oe.transform.baseVal.consolidate())?Ve((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Pe)}),", ",")",")");function Ge(t){return((t=Math.exp(t))+1/t)/2}var We,Ze,Ke=function t(n,e,r){function i(t,i){var o,a,u=t[0],l=t[1],s=t[2],c=i[0],f=i[1],h=i[2],p=c-u,d=f-l,g=p*p+d*d;if(g<1e-12)a=Math.log(h/s)/n,o=function(t){return[u+t*p,l+t*d,s*Math.exp(n*t*a)]};else{var v=Math.sqrt(g),m=(h*h-s*s+r*g)/(2*s*e*v),y=(h*h-s*s-r*g)/(2*h*e*v),_=Math.log(Math.sqrt(m*m+1)-m),w=Math.log(Math.sqrt(y*y+1)-y);a=(w-_)/n,o=function(t){var r=t*a,i=Ge(_),o=s/(e*v)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(n*r+_)-function(t){return((t=Math.exp(t))-1/t)/2}(_));return[u+o*p,l+o*d,s*i/Ge(n*r+_)]}}return o.duration=1e3*a*n/Math.SQRT2,o}return i.rho=function(n){var e=Math.max(.001,+n),r=e*e;return t(e,r,r*r)},i}(Math.SQRT2,2,4),Je=0,Qe=0,tr=0,nr=0,er=0,rr=0,ir="object"==typeof performance&&performance.now?performance:Date,or="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ar(){return er||(or(ur),er=ir.now()+rr)}function ur(){er=0}function lr(){this._call=this._time=this._next=null}function sr(t,n,e){var r=new lr;return r.restart(t,n,e),r}function cr(){er=(nr=ir.now())+rr,Je=Qe=0;try{!function(){ar(),++Je;for(var t,n=We;n;)(t=er-n._time)>=0&&n._call.call(null,t),n=n._next;--Je}()}finally{Je=0,function(){var t,n,e=We,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:We=n);Ze=t,hr(r)}(),er=0}}function fr(){var t=ir.now(),n=t-nr;n>1e3&&(rr-=n,nr=t)}function hr(t){Je||(Qe&&(Qe=clearTimeout(Qe)),t-er>24?(t<1/0&&(Qe=setTimeout(cr,t-ir.now()-rr)),tr&&(tr=clearInterval(tr))):(tr||(nr=ir.now(),tr=setInterval(fr,1e3)),Je=1,or(cr)))}function pr(t,n,e){var r=new lr;return n=null==n?0:+n,r.restart((e=>{r.stop(),t(e+n)}),n,e),r}lr.prototype=sr.prototype={constructor:lr,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?ar():+e)+(null==n?0:+n),this._next||Ze===this||(Ze?Ze._next=this:We=this,Ze=this),this._call=t,this._time=e,hr()},stop:function(){this._call&&(this._call=null,this._time=1/0,hr())}};var dr=yt("start","end","cancel","interrupt"),gr=[];function vr(t,n,e,r,i,o){var a=t.__transition;if(a){if(e in a)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function o(t){e.state=1,e.timer.restart(a,e.delay,e.time),e.delay<=t&&a(t-e.delay)}function a(o){var s,c,f,h;if(1!==e.state)return l();for(s in i)if((h=i[s]).name===e.name){if(3===h.state)return pr(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[s]):+s<n&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[s])}if(pr((function(){3===e.state&&(e.state=4,e.timer.restart(u,e.delay,e.time),u(o))})),e.state=2,e.on.call("start",t,t.__data__,e.index,e.group),2===e.state){for(e.state=3,r=new Array(f=e.tween.length),s=0,c=-1;s<f;++s)(h=e.tween[s].value.call(t,t.__data__,e.index,e.group))&&(r[++c]=h);r.length=c+1}}function u(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(l),e.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===e.state&&(e.on.call("end",t,t.__data__,e.index,e.group),l())}function l(){for(var r in e.state=6,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=sr(o,0,e.time)}(t,e,{name:n,index:r,group:i,on:dr,tween:gr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function mr(t,n){var e=_r(t,n);if(e.state>0)throw new Error("too late; already scheduled");return e}function yr(t,n){var e=_r(t,n);if(e.state>3)throw new Error("too late; already running");return e}function _r(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function wr(t,n){var e,r,i,o=t.__transition,a=!0;if(o){for(i in n=null==n?null:n+"",o)(e=o[i]).name===n?(r=e.state>2&&e.state<5,e.state=6,e.timer.stop(),e.on.call(r?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete o[i]):a=!1;a&&delete t.__transition}}function xr(t,n){var e,r;return function(){var i=yr(this,t),o=i.tween;if(o!==e)for(var a=0,u=(r=e=o).length;a<u;++a)if(r[a].name===n){(r=r.slice()).splice(a,1);break}i.tween=r}}function br(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var o=yr(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:n,value:e},l=0,s=i.length;l<s;++l)if(i[l].name===n){i[l]=u;break}l===s&&i.push(u)}o.tween=i}}function Mr(t,n,e){var r=t._id;return t.each((function(){var t=yr(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)})),function(t){return _r(t,r).value[n]}}function kr(t,n){var e;return("number"==typeof n?Fe:n instanceof de?Ce:(e=de(n))?(n=e,Ce):Ie)(t,n)}function Ar(t){return function(){this.removeAttribute(t)}}function Sr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Tr(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=n(r=a,e)}}function Er(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=n(r=a,e)}}function Nr(t,n,e){var r,i,o;return function(){var a,u,l=e(this);if(null!=l)return(a=this.getAttribute(t))===(u=l+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,l));this.removeAttribute(t)}}function Cr(t,n,e){var r,i,o;return function(){var a,u,l=e(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(u=l+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,l));this.removeAttributeNS(t.space,t.local)}}function zr(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function Dr(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function Yr(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&Dr(t,i)),e}return i._value=n,i}function Fr(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&zr(t,i)),e}return i._value=n,i}function Lr(t,n){return function(){mr(this,t).delay=+n.apply(this,arguments)}}function jr(t,n){return n=+n,function(){mr(this,t).delay=n}}function $r(t,n){return function(){yr(this,t).duration=+n.apply(this,arguments)}}function Ir(t,n){return n=+n,function(){yr(this,t).duration=n}}function Ur(t,n){if("function"!=typeof n)throw new Error;return function(){yr(this,t).ease=n}}function Hr(t,n,e){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t}))}(n)?mr:yr;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(n,e),a.on=i}}var Or=jn.prototype.constructor;function qr(t){return function(){this.style.removeProperty(t)}}function Pr(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function Vr(t,n,e){var r,i;function o(){var o=n.apply(this,arguments);return o!==i&&(r=(i=o)&&Pr(t,o,e)),r}return o._value=n,o}function Br(t){return function(n){this.textContent=t.call(this,n)}}function Rr(t){var n,e;function r(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&Br(r)),n}return r._value=t,r}var Xr=0;function Gr(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function Wr(){return++Xr}var Zr=jn.prototype;Gr.prototype=function(t){return jn().transition(t)}.prototype={constructor:Gr,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=Ct(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var u,l,s=r[a],c=s.length,f=o[a]=new Array(c),h=0;h<c;++h)(u=s[h])&&(l=t.call(u,u.__data__,h,s))&&("__data__"in u&&(l.__data__=u.__data__),f[h]=l,vr(f[h],n,e,h,f,_r(u,e)));return new Gr(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=Yt(t));for(var r=this._groups,i=r.length,o=[],a=[],u=0;u<i;++u)for(var l,s=r[u],c=s.length,f=0;f<c;++f)if(l=s[f]){for(var h,p=t.call(l,l.__data__,f,s),d=_r(l,e),g=0,v=p.length;g<v;++g)(h=p[g])&&vr(h,n,e,g,p,d);o.push(p),a.push(l)}return new Gr(o,a,n,e)},filter:function(t){"function"!=typeof t&&(t=Ft(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,l=r[i]=[],s=0;s<u;++s)(o=a[s])&&t.call(o,o.__data__,s,a)&&l.push(o);return new Gr(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var l,s=n[u],c=e[u],f=s.length,h=a[u]=new Array(f),p=0;p<f;++p)(l=s[p]||c[p])&&(h[p]=l);for(;u<r;++u)a[u]=n[u];return new Gr(a,this._parents,this._name,this._id)},selection:function(){return new Or(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=Wr(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],l=u.length,s=0;s<l;++s)if(a=u[s]){var c=_r(a,n);vr(a,t,e,s,u,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Gr(r,this._parents,t,e)},call:Zr.call,nodes:Zr.nodes,node:Zr.node,size:Zr.size,empty:Zr.empty,each:Zr.each,on:function(t,n){var e=this._id;return arguments.length<2?_r(this.node(),e).on.on(t):this.each(Hr(e,t,n))},attr:function(t,n){var e=At(t),r="transform"===e?Xe:kr;return this.attrTween(t,"function"==typeof n?(e.local?Cr:Nr)(e,r,Mr(this,"attr."+t,n)):null==n?(e.local?Sr:Ar)(e):(e.local?Er:Tr)(e,r,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=At(t);return this.tween(e,(r.local?Yr:Fr)(r,n))},style:function(t,n,e){var r="transform"==(t+="")?Re:kr;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var o=rn(this,t),a=(this.style.removeProperty(t),rn(this,t));return o===a?null:o===e&&a===r?i:i=n(e=o,r=a)}}(t,r)).on("end.style."+t,qr(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var r,i,o;return function(){var a=rn(this,t),u=e(this),l=u+"";return null==u&&(this.style.removeProperty(t),l=u=rn(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=n(r=a,u))}}(t,r,Mr(this,"style."+t,n))).each(function(t,n){var e,r,i,o,a="style."+n,u="end."+a;return function(){var l=yr(this,t),s=l.on,c=null==l.value[a]?o||(o=qr(n)):void 0;s===e&&i===c||(r=(e=s).copy()).on(u,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,n,e){var r,i,o=e+"";return function(){var a=rn(this,t);return a===o?null:a===r?i:i=n(r=a,e)}}(t,r,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,Vr(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(Mr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,Rr(t))},remove:function(){return this.on("end.remove",function(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}(this._id))},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=_r(this.node(),e).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==n?xr:br)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?Lr:jr)(n,t)):_r(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?$r:Ir)(n,t)):_r(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(Ur(n,t)):_r(this.node(),n).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,n){return function(){var e=n.apply(this,arguments);if("function"!=typeof e)throw new Error;yr(this,t).ease=e}}(this._id,t))},end:function(){var t,n,e=this,r=e._id,i=e.size();return new Promise((function(o,a){var u={value:a},l={value:function(){0==--i&&o()}};e.each((function(){var e=yr(this,r),i=e.on;i!==t&&((n=(t=i).copy())._.cancel.push(u),n._.interrupt.push(u),n._.end.push(l)),e.on=n})),0===i&&o()}))},[Symbol.iterator]:Zr[Symbol.iterator]};var Kr={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Jr(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}jn.prototype.interrupt=function(t){return this.each((function(){wr(this,t)}))},jn.prototype.transition=function(t){var n,e;t instanceof Gr?(n=t._id,t=t._name):(n=Wr(),(e=Kr).time=ar(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],l=u.length,s=0;s<l;++s)(a=u[s])&&vr(a,t,n,s,u,e||Jr(a,n));return new Gr(r,this._parents,t,n)};var Qr=t=>()=>t;function ti(t,{sourceEvent:n,target:e,selection:r,mode:i,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function ni(t){t.stopImmediatePropagation()}function ei(t){t.preventDefault(),t.stopImmediatePropagation()}var ri={name:"drag"},ii={name:"space"},oi={name:"handle"},ai={name:"center"};const{abs:ui,max:li,min:si}=Math;function ci(t){return[+t[0],+t[1]]}function fi(t){return[ci(t[0]),ci(t[1])]}var hi={name:"x",handles:["w","e"].map(_i),input:function(t,n){return null==t?null:[[+t[0],n[0][1]],[+t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},pi={name:"y",handles:["n","s"].map(_i),input:function(t,n){return null==t?null:[[n[0][0],+t[0]],[n[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},di={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},gi={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},vi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},mi={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},yi={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function _i(t){return{type:t}}function wi(t){return!t.ctrlKey&&!t.button}function xi(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function bi(){return navigator.maxTouchPoints||"ontouchstart"in this}function Mi(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function ki(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Ai(){return function(t){var n,e=xi,r=wi,i=bi,o=!0,a=yt("start","brush","end"),u=6;function l(n){var e=n.property("__brush",g).selectAll(".overlay").data([_i("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",di.overlay).merge(e).each((function(){var t=Mi(this).extent;$n(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),n.selectAll(".selection").data([_i("selection")]).enter().append("rect").attr("class","selection").attr("cursor",di.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=n.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return di[t.type]})),n.each(s).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(i).on("touchstart.brush",h).on("touchmove.brush",p).on("touchend.brush touchcancel.brush",d).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function s(){var t=$n(this),n=Mi(this).selection;n?(t.selectAll(".selection").style("display",null).attr("x",n[0][0]).attr("y",n[0][1]).attr("width",n[1][0]-n[0][0]).attr("height",n[1][1]-n[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?n[1][0]-u/2:n[0][0]-u/2})).attr("y",(function(t){return"s"===t.type[0]?n[1][1]-u/2:n[0][1]-u/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?n[1][0]-n[0][0]+u:u})).attr("height",(function(t){return"e"===t.type||"w"===t.type?n[1][1]-n[0][1]+u:u}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function c(t,n,e){var r=t.__brush.emitter;return!r||e&&r.clean?new f(t,n,e):r}function f(t,n,e){this.that=t,this.args=n,this.state=t.__brush,this.active=0,this.clean=e}function h(e){if((!n||e.touches)&&r.apply(this,arguments)){var i,a,u,l,f,h,p,d,g,v,m,y=this,_=e.target.__data__.type,w="selection"===(o&&e.metaKey?_="overlay":_)?ri:o&&e.altKey?ai:oi,x=t===pi?null:mi[_],b=t===hi?null:yi[_],M=Mi(y),k=M.extent,A=M.selection,S=k[0][0],T=k[0][1],E=k[1][0],N=k[1][1],C=0,z=0,D=x&&b&&o&&e.shiftKey,Y=Array.from(e.touches||[e],(t=>{const n=t.identifier;return(t=In(t,y)).point0=t.slice(),t.identifier=n,t}));if("overlay"===_){A&&(g=!0);const n=[Y[0],Y[1]||Y[0]];M.selection=A=[[i=t===pi?S:si(n[0][0],n[1][0]),u=t===hi?T:si(n[0][1],n[1][1])],[f=t===pi?E:li(n[0][0],n[1][0]),p=t===hi?N:li(n[0][1],n[1][1])]],Y.length>1&&U()}else i=A[0][0],u=A[0][1],f=A[1][0],p=A[1][1];a=i,l=u,h=f,d=p;var F=$n(y).attr("pointer-events","none"),L=F.selectAll(".overlay").attr("cursor",di[_]);wr(y);var j=c(y,arguments,!0).beforestart();if(e.touches)j.moved=I,j.ended=H;else{var $=$n(e.view).on("mousemove.brush",I,!0).on("mouseup.brush",H,!0);o&&$.on("keydown.brush",O,!0).on("keyup.brush",q,!0),qn(e.view)}s.call(y),j.start(e,w.name)}function I(t){for(const n of t.changedTouches||[t])for(const t of Y)t.identifier===n.identifier&&(t.cur=In(n,y));if(D&&!v&&!m&&1===Y.length){const t=Y[0];ui(t.cur[0]-t[0])>ui(t.cur[1]-t[1])?m=!0:v=!0}for(const t of Y)t.cur&&(t[0]=t.cur[0],t[1]=t.cur[1]);g=!0,ei(t),U(t)}function U(t){const n=Y[0],e=n.point0;var r;switch(C=n[0]-e[0],z=n[1]-e[1],w){case ii:case ri:x&&(C=li(S-i,si(E-f,C)),a=i+C,h=f+C),b&&(z=li(T-u,si(N-p,z)),l=u+z,d=p+z);break;case oi:Y[1]?(x&&(a=li(S,si(E,Y[0][0])),h=li(S,si(E,Y[1][0])),x=1),b&&(l=li(T,si(N,Y[0][1])),d=li(T,si(N,Y[1][1])),b=1)):(x<0?(C=li(S-i,si(E-i,C)),a=i+C,h=f):x>0&&(C=li(S-f,si(E-f,C)),a=i,h=f+C),b<0?(z=li(T-u,si(N-u,z)),l=u+z,d=p):b>0&&(z=li(T-p,si(N-p,z)),l=u,d=p+z));break;case ai:x&&(a=li(S,si(E,i-C*x)),h=li(S,si(E,f+C*x))),b&&(l=li(T,si(N,u-z*b)),d=li(T,si(N,p+z*b)))}h<a&&(x*=-1,r=i,i=f,f=r,r=a,a=h,h=r,_ in gi&&L.attr("cursor",di[_=gi[_]])),d<l&&(b*=-1,r=u,u=p,p=r,r=l,l=d,d=r,_ in vi&&L.attr("cursor",di[_=vi[_]])),M.selection&&(A=M.selection),v&&(a=A[0][0],h=A[1][0]),m&&(l=A[0][1],d=A[1][1]),A[0][0]===a&&A[0][1]===l&&A[1][0]===h&&A[1][1]===d||(M.selection=[[a,l],[h,d]],s.call(y),j.brush(t,w.name))}function H(t){if(ni(t),t.touches){if(t.touches.length)return;n&&clearTimeout(n),n=setTimeout((function(){n=null}),500)}else Pn(t.view,g),$.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);F.attr("pointer-events","all"),L.attr("cursor",di.overlay),M.selection&&(A=M.selection),ki(A)&&(M.selection=null,s.call(y)),j.end(t,w.name)}function O(t){switch(t.keyCode){case 16:D=x&&b;break;case 18:w===oi&&(x&&(f=h-C*x,i=a+C*x),b&&(p=d-z*b,u=l+z*b),w=ai,U());break;case 32:w!==oi&&w!==ai||(x<0?f=h-C:x>0&&(i=a-C),b<0?p=d-z:b>0&&(u=l-z),w=ii,L.attr("cursor",di.selection),U());break;default:return}ei(t)}function q(t){switch(t.keyCode){case 16:D&&(v=m=D=!1,U());break;case 18:w===ai&&(x<0?f=h:x>0&&(i=a),b<0?p=d:b>0&&(u=l),w=oi,U());break;case 32:w===ii&&(t.altKey?(x&&(f=h-C*x,i=a+C*x),b&&(p=d-z*b,u=l+z*b),w=ai):(x<0?f=h:x>0&&(i=a),b<0?p=d:b>0&&(u=l),w=oi),L.attr("cursor",di[_]),U());break;default:return}ei(t)}}function p(t){c(this,arguments).moved(t)}function d(t){c(this,arguments).ended(t)}function g(){var n=this.__brush||{selection:null};return n.extent=fi(e.apply(this,arguments)),n.dim=t,n}return l.move=function(n,e){n.tween?n.on("start.brush",(function(t){c(this,arguments).beforestart().start(t)})).on("interrupt.brush end.brush",(function(t){c(this,arguments).end(t)})).tween("brush",(function(){var n=this,r=n.__brush,i=c(n,arguments),o=r.selection,a=t.input("function"==typeof e?e.apply(this,arguments):e,r.extent),u=Ue(o,a);function l(t){r.selection=1===t&&null===a?null:u(t),s.call(n),i.brush()}return null!==o&&null!==a?l:l(1)})):n.each((function(){var n=this,r=arguments,i=n.__brush,o=t.input("function"==typeof e?e.apply(n,r):e,i.extent),a=c(n,r).beforestart();wr(n),i.selection=null===o?null:o,s.call(n),a.start().brush().end()}))},l.clear=function(t){l.move(t,null)},f.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,n){return this.starting?(this.starting=!1,this.emit("start",t,n)):this.emit("brush",t),this},brush:function(t,n){return this.emit("brush",t,n),this},end:function(t,n){return 0==--this.active&&(delete this.state.emitter,this.emit("end",t,n)),this},emit:function(n,e,r){var i=$n(this.that).datum();a.call(n,this.that,new ti(n,{sourceEvent:e,target:l,selection:t.output(this.state.selection),mode:r,dispatch:a}),i)}},l.extent=function(t){return arguments.length?(e="function"==typeof t?t:Qr(fi(t)),l):e},l.filter=function(t){return arguments.length?(r="function"==typeof t?t:Qr(!!t),l):r},l.touchable=function(t){return arguments.length?(i="function"==typeof t?t:Qr(!!t),l):i},l.handleSize=function(t){return arguments.length?(u=+t,l):u},l.keyModifiers=function(t){return arguments.length?(o=!!t,l):o},l.on=function(){var t=a.on.apply(a,arguments);return t===a?l:t},l}(hi)}const Si=Math.PI,Ti=2*Si,Ei=1e-6,Ni=Ti-Ei;function Ci(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function zi(){return new Ci}Ci.prototype=zi.prototype={constructor:Ci,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,i,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,n,e,r,i){t=+t,n=+n,e=+e,r=+r,i=+i;var o=this._x1,a=this._y1,u=e-t,l=r-n,s=o-t,c=a-n,f=s*s+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(f>Ei)if(Math.abs(c*u-l*s)>Ei&&i){var h=e-o,p=r-a,d=u*u+l*l,g=h*h+p*p,v=Math.sqrt(d),m=Math.sqrt(f),y=i*Math.tan((Si-Math.acos((d+f-g)/(2*v*m)))/2),_=y/m,w=y/v;Math.abs(_-1)>Ei&&(this._+="L"+(t+_*s)+","+(n+_*c)),this._+="A"+i+","+i+",0,0,"+ +(c*h>s*p)+","+(this._x1=t+w*u)+","+(this._y1=n+w*l)}else this._+="L"+(this._x1=t)+","+(this._y1=n);else;},arc:function(t,n,e,r,i,o){t=+t,n=+n,o=!!o;var a=(e=+e)*Math.cos(r),u=e*Math.sin(r),l=t+a,s=n+u,c=1^o,f=o?r-i:i-r;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+l+","+s:(Math.abs(this._x1-l)>Ei||Math.abs(this._y1-s)>Ei)&&(this._+="L"+l+","+s),e&&(f<0&&(f=f%Ti+Ti),f>Ni?this._+="A"+e+","+e+",0,1,"+c+","+(t-a)+","+(n-u)+"A"+e+","+e+",0,1,"+c+","+(this._x1=l)+","+(this._y1=s):f>Ei&&(this._+="A"+e+","+e+",0,"+ +(f>=Si)+","+c+","+(this._x1=t+e*Math.cos(i))+","+(this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+-e+"Z"},toString:function(){return this._}};var Di={},Yi={};function Fi(t){return new Function("d","return {"+t.map((function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'})).join(",")+"}")}function Li(t){var n=Object.create(null),e=[];return t.forEach((function(t){for(var r in t)r in n||e.push(n[r]=r)})),e}function ji(t,n){var e=t+"",r=e.length;return r<n?new Array(n-r+1).join(0)+e:e}function $i(t){var n=t.getUTCHours(),e=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+ji(-t,6):t>9999?"+"+ji(t,6):ji(t,4)}(t.getUTCFullYear())+"-"+ji(t.getUTCMonth()+1,2)+"-"+ji(t.getUTCDate(),2)+(i?"T"+ji(n,2)+":"+ji(e,2)+":"+ji(r,2)+"."+ji(i,3)+"Z":r?"T"+ji(n,2)+":"+ji(e,2)+":"+ji(r,2)+"Z":e||n?"T"+ji(n,2)+":"+ji(e,2)+"Z":"")}var Ii=function(t){var n=new RegExp('["'+t+"\n\r]"),e=t.charCodeAt(0);function r(t,n){var r,i=[],o=t.length,a=0,u=0,l=o<=0,s=!1;function c(){if(l)return Yi;if(s)return s=!1,Di;var n,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(n=a)>=o?l=!0:10===(r=t.charCodeAt(a++))?s=!0:13===r&&(s=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,n-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(n=a++)))s=!0;else if(13===r)s=!0,10===t.charCodeAt(a)&&++a;else if(r!==e)continue;return t.slice(i,n)}return l=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=c())!==Yi;){for(var f=[];r!==Di&&r!==Yi;)f.push(r),r=c();n&&null==(f=n(f,u++))||i.push(f)}return i}function i(n,e){return n.map((function(n){return e.map((function(t){return a(n[t])})).join(t)}))}function o(n){return n.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?$i(t):n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var e,i,o=r(t,(function(t,r){if(e)return e(t,r-1);i=t,e=n?function(t,n){var e=Fi(t);return function(r,i){return n(e(r),i,t)}}(t,n):Fi(t)}));return o.columns=i||[],o},parseRows:r,format:function(n,e){return null==e&&(e=Li(n)),[e.map(a).join(t)].concat(i(n,e)).join("\n")},formatBody:function(t,n){return null==n&&(n=Li(t)),i(t,n).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}(",").parse;function Ui(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Hi(t,n){return fetch(t,n).then(Ui)}var Oi,qi=(Oi=Ii,function(t,n,e){return 2===arguments.length&&"function"==typeof n&&(e=n,n=void 0),Hi(t,n).then((function(t){return Oi(t,e)}))});function Pi(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function Vi(t,n){return fetch(t,n).then(Pi)}function Bi(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function Ri(t){return(t=Bi(Math.abs(t)))?t[1]:NaN}var Xi,Gi=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Wi(t){if(!(n=Gi.exec(t)))throw new Error("invalid format: "+t);var n;return new Zi({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function Zi(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Ki(t,n){var e=Bi(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Wi.prototype=Zi.prototype,Zi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ji={"%":(t,n)=>(100*t).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>Ki(100*t,n),r:Ki,s:function(t,n){var e=Bi(t,n);if(!e)return t+"";var r=e[0],i=e[1],o=i-(Xi=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Bi(t,Math.max(0,n+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Qi(t){return t}var to,no,eo,ro=Array.prototype.map,io=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function oo(t){var n,e,r=void 0===t.grouping||void 0===t.thousands?Qi:(n=ro.call(t.grouping,Number),e=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,u=n[0],l=0;i>0&&u>0&&(l+u+1>r&&(u=Math.max(1,r-l)),o.push(t.substring(i-=u,i+u)),!((l+=u+1)>r));)u=n[a=(a+1)%n.length];return o.reverse().join(e)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?Qi:function(t){return function(n){return n.replace(/[0-9]/g,(function(n){return t[+n]}))}}(ro.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",s=void 0===t.minus?"":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function f(t){var n=(t=Wi(t)).fill,e=t.align,f=t.sign,h=t.symbol,p=t.zero,d=t.width,g=t.comma,v=t.precision,m=t.trim,y=t.type;"n"===y?(g=!0,y="g"):Ji[y]||(void 0===v&&(v=12),m=!0,y="g"),(p||"0"===n&&"="===e)&&(p=!0,n="0",e="=");var _="$"===h?i:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===h?o:/[%p]/.test(y)?l:"",x=Ji[y],b=/[defgprs%]/.test(y);function M(t){var i,o,l,h=_,M=w;if("c"===y)M=x(t)+M,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:x(Math.abs(t),v),m&&(t=function(t){t:for(var n,e=t.length,r=1,i=-1;r<e;++r)switch(t[r]){case".":i=n=r;break;case"0":0===i&&(i=r),n=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(n+1):t}(t)),k&&0==+t&&"+"!==f&&(k=!1),h=(k?"("===f?f:s:"-"===f||"("===f?"":f)+h,M=("s"===y?io[8+Xi/3]:"")+M+(k&&"("===f?")":""),b)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){M=(46===l?a+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}g&&!p&&(t=r(t,1/0));var A=h.length+t.length+M.length,S=A<d?new Array(d-A+1).join(n):"";switch(g&&p&&(t=r(S+t,S.length?d-M.length:1/0),S=""),e){case"<":t=h+t+M+S;break;case"=":t=h+S+t+M;break;case"^":t=S.slice(0,A=S.length>>1)+h+t+M+S.slice(A);break;default:t=S+h+t+M}return u(t)}return v=void 0===v?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return t+""},M}return{format:f,formatPrefix:function(t,n){var e=f(((t=Wi(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Ri(n)/3))),i=Math.pow(10,-r),o=io[8+r/3];return function(t){return e(i*t)+o}}}}to=oo({thousands:",",grouping:[3],currency:["$",""]}),no=to.format,eo=to.formatPrefix;var ao=1e-6,uo=Math.PI,lo=uo/2,so=uo/4,co=2*uo,fo=180/uo,ho=uo/180,po=Math.abs,go=Math.atan,vo=Math.atan2,mo=Math.cos,yo=Math.exp,_o=Math.log,wo=Math.pow,xo=Math.sin,bo=Math.sign||function(t){return t>0?1:t<0?-1:0},Mo=Math.sqrt,ko=Math.tan;function Ao(t){return t>1?lo:t<-1?-lo:Math.asin(t)}function So(){}function To(t,n){t&&No.hasOwnProperty(t.type)&&No[t.type](t,n)}var Eo={Feature:function(t,n){To(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)To(e[r].geometry,n)}},No={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){Co(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Co(e[r],n,0)},Polygon:function(t,n){zo(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)zo(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)To(e[r],n)}};function Co(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function zo(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)Co(t[e],n,1);n.polygonEnd()}function Do(t,n){t&&Eo.hasOwnProperty(t.type)?Eo[t.type](t,n):To(t,n)}function Yo(t){return[vo(t[1],t[0]),Ao(t[2])]}function Fo(t){var n=t[0],e=t[1],r=mo(e);return[r*mo(n),r*xo(n),xo(e)]}function Lo(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function jo(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function $o(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Io(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function Uo(t){var n=Mo(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function Ho(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e}function Oo(t,n){return[po(t)>uo?t+Math.round(-t/co)*co:t,n]}function qo(t){return function(n,e){return[(n+=t)>uo?n-co:n<-uo?n+co:n,e]}}function Po(t){var n=qo(t);return n.invert=qo(-t),n}function Vo(t,n){var e=mo(t),r=xo(t),i=mo(n),o=xo(n);function a(t,n){var a=mo(n),u=mo(t)*a,l=xo(t)*a,s=xo(n),c=s*e+u*r;return[vo(l*i-c*o,u*e-s*r),Ao(c*i+l*o)]}return a.invert=function(t,n){var a=mo(n),u=mo(t)*a,l=xo(t)*a,s=xo(n),c=s*i-l*o;return[vo(l*i+s*o,u*e+c*r),Ao(c*e-u*r)]},a}function Bo(t,n){(n=Fo(n))[0]-=t,Uo(n);var e=function(t){return t>1?0:t<-1?uo:Math.acos(t)}(-n[1]);return((-n[2]<0?-e:e)+co-ao)%co}function Ro(){var t,n=[];return{point:function(n,e,r){t.push([n,e,r])},lineStart:function(){n.push(t=[])},lineEnd:So,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function Xo(t,n){return po(t[0]-n[0])<ao&&po(t[1]-n[1])<ao}function Go(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Wo(t,n,e,r,i){var o,a,u=[],l=[];if(t.forEach((function(t){if(!((n=t.length-1)<=0)){var n,e,r=t[0],a=t[n];if(Xo(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<n;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2e-6}u.push(e=new Go(r,t,null,!0)),l.push(e.o=new Go(r,null,e,!1)),u.push(e=new Go(a,t,null,!1)),l.push(e.o=new Go(a,null,e,!0))}})),u.length){for(l.sort(n),Zo(u),Zo(l),o=0,a=l.length;o<a;++o)l[o].e=e=!e;for(var s,c,f=u[0];;){for(var h=f,p=!0;h.v;)if((h=h.n)===f)return;s=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(o=0,a=s.length;o<a;++o)i.point((c=s[o])[0],c[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(p)for(s=h.p.z,o=s.length-1;o>=0;--o)i.point((c=s[o])[0],c[1]);else r(h.x,h.p.x,-1,i);h=h.p}s=(h=h.o).z,p=!p}while(!h.v);i.lineEnd()}}}function Zo(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}function Ko(t){return po(t[0])<=uo?t[0]:bo(t[0])*((po(t[0])+uo)%co-uo)}function Jo(t,n,e,r){return function(i){var o,a,u,l=n(i),s=Ro(),c=n(s),f=!1,h={point:p,lineStart:g,lineEnd:v,polygonStart:function(){h.point=m,h.lineStart=y,h.lineEnd=_,a=[],o=[]},polygonEnd:function(){h.point=p,h.lineStart=g,h.lineEnd=v,a=it(a);var t=function(t,n){var e=Ko(n),r=n[1],i=xo(r),o=[xo(e),-mo(e),0],a=0,u=0,l=new Z;1===i?r=lo+ao:-1===i&&(r=-lo-ao);for(var s=0,c=t.length;s<c;++s)if(h=(f=t[s]).length)for(var f,h,p=f[h-1],d=Ko(p),g=p[1]/2+so,v=xo(g),m=mo(g),y=0;y<h;++y,d=w,v=b,m=M,p=_){var _=f[y],w=Ko(_),x=_[1]/2+so,b=xo(x),M=mo(x),k=w-d,A=k>=0?1:-1,S=A*k,T=S>uo,E=v*b;if(l.add(vo(E*A*xo(S),m*M+E*mo(S))),a+=T?k+A*co:k,T^d>=e^w>=e){var N=jo(Fo(p),Fo(_));Uo(N);var C=jo(o,N);Uo(C);var z=(T^k>=0?-1:1)*Ao(C[2]);(r>z||r===z&&(N[0]||N[1]))&&(u+=T^k>=0?1:-1)}}return(a<-1e-6||a<ao&&l<-1e-12)^1&u}(o,r);a.length?(f||(i.polygonStart(),f=!0),Wo(a,ta,t,e,i)):t&&(f||(i.polygonStart(),f=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(n,e){t(n,e)&&i.point(n,e)}function d(t,n){l.point(t,n)}function g(){h.point=d,l.lineStart()}function v(){h.point=p,l.lineEnd()}function m(t,n){u.push([t,n]),c.point(t,n)}function y(){c.lineStart(),u=[]}function _(){m(u[0][0],u[0][1]),c.lineEnd();var t,n,e,r,l=c.clean(),h=s.result(),p=h.length;if(u.pop(),o.push(u),u=null,p)if(1&l){if((n=(e=h[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),t=0;t<n;++t)i.point((r=e[t])[0],r[1]);i.lineEnd()}}else p>1&&2&l&&h.push(h.pop().concat(h.shift())),a.push(h.filter(Qo))}return h}}function Qo(t){return t.length>1}function ta(t,n){return((t=t.x)[0]<0?t[1]-lo-ao:lo-t[1])-((n=n.x)[0]<0?n[1]-lo-ao:lo-n[1])}Oo.invert=Oo;var na=Jo((function(){return!0}),(function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(o,a){var u=o>0?uo:-uo,l=po(o-e);po(l-uo)<ao?(t.point(e,r=(r+a)/2>0?lo:-lo),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),t.point(o,r),n=0):i!==u&&l>=uo&&(po(e-i)<ao&&(e-=i*ao),po(o-u)<ao&&(o-=u*ao),r=function(t,n,e,r){var i,o,a=xo(t-e);return po(a)>ao?go((xo(n)*(o=mo(r))*xo(e)-xo(r)*(i=mo(n))*xo(t))/(i*o*a)):(n+r)/2}(e,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),n=0),t.point(e=o,r=a),i=u},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}}),(function(t,n,e,r){var i;if(null==t)i=e*lo,r.point(-uo,i),r.point(0,i),r.point(uo,i),r.point(uo,0),r.point(uo,-i),r.point(0,-i),r.point(-uo,-i),r.point(-uo,0),r.point(-uo,i);else if(po(t[0]-n[0])>ao){var o=t[0]<n[0]?uo:-uo;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])}),[-uo,-lo]);function ea(t){var n=mo(t),e=6*ho,r=n>0,i=po(n)>ao;function o(t,e){return mo(t)*mo(e)>n}function a(t,e,r){var i=[1,0,0],o=jo(Fo(t),Fo(e)),a=Lo(o,o),u=o[0],l=a-u*u;if(!l)return!r&&t;var s=n*a/l,c=-n*u/l,f=jo(i,o),h=Io(i,s);$o(h,Io(o,c));var p=f,d=Lo(h,p),g=Lo(p,p),v=d*d-g*(Lo(h,h)-1);if(!(v<0)){var m=Mo(v),y=Io(p,(-d-m)/g);if($o(y,h),y=Yo(y),!r)return y;var _,w=t[0],x=e[0],b=t[1],M=e[1];x<w&&(_=w,w=x,x=_);var k=x-w,A=po(k-uo)<ao;if(!A&&M<b&&(_=b,b=M,M=_),A||k<ao?A?b+M>0^y[1]<(po(y[0]-w)<ao?b:M):b<=y[1]&&y[1]<=M:k>uo^(w<=y[0]&&y[0]<=x)){var S=Io(p,(-d+m)/g);return $o(S,h),[y,Yo(S)]}}}function u(n,e){var i=r?t:uo-t,o=0;return n<-i?o|=1:n>i&&(o|=2),e<-i?o|=4:e>i&&(o|=8),o}return Jo(o,(function(t){var n,e,l,s,c;return{lineStart:function(){s=l=!1,c=1},point:function(f,h){var p,d=[f,h],g=o(f,h),v=r?g?0:u(f,h):g?u(f+(f<0?uo:-uo),h):0;if(!n&&(s=l=g)&&t.lineStart(),g!==l&&(!(p=a(n,d))||Xo(n,p)||Xo(d,p))&&(d[2]=1),g!==l)c=0,g?(t.lineStart(),p=a(d,n),t.point(p[0],p[1])):(p=a(n,d),t.point(p[0],p[1],2),t.lineEnd()),n=p;else if(i&&n&&r^g){var m;v&e||!(m=a(d,n,!0))||(c=0,r?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1],3)))}!g||n&&Xo(n,d)||t.point(d[0],d[1]),n=d,l=g,e=v},lineEnd:function(){l&&t.lineEnd(),n=null},clean:function(){return c|(s&&l)<<1}}}),(function(n,r,i,o){!function(t,n,e,r,i,o){if(e){var a=mo(n),u=xo(n),l=r*e;null==i?(i=n+r*co,o=n-l/2):(i=Bo(a,i),o=Bo(a,o),(r>0?i<o:i>o)&&(i+=r*co));for(var s,c=i;r>0?c>o:c<o;c-=l)s=Yo([a,-u*mo(c),-u*xo(c)]),t.point(s[0],s[1])}}(o,t,e,i,n,r)}),r?[0,-t]:[-uo,t-uo])}var ra=1e9,ia=-ra;function oa(t,n,e,r){function i(i,o){return t<=i&&i<=e&&n<=o&&o<=r}function o(i,o,u,s){var c=0,f=0;if(null==i||(c=a(i,u))!==(f=a(o,u))||l(i,o)<0^u>0)do{s.point(0===c||3===c?t:e,c>1?r:n)}while((c=(c+u+4)%4)!==f);else s.point(o[0],o[1])}function a(r,i){return po(r[0]-t)<ao?i>0?0:3:po(r[0]-e)<ao?i>0?2:1:po(r[1]-n)<ao?i>0?1:0:i>0?3:2}function u(t,n){return l(t.x,n.x)}function l(t,n){var e=a(t,1),r=a(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}return function(a){var l,s,c,f,h,p,d,g,v,m,y,_=a,w=Ro(),x={point:b,lineStart:function(){x.point=M,s&&s.push(c=[]);m=!0,v=!1,d=g=NaN},lineEnd:function(){l&&(M(f,h),p&&v&&w.rejoin(),l.push(w.result()));x.point=b,v&&_.lineEnd()},polygonStart:function(){_=w,l=[],s=[],y=!0},polygonEnd:function(){var n=function(){for(var n=0,e=0,i=s.length;e<i;++e)for(var o,a,u=s[e],l=1,c=u.length,f=u[0],h=f[0],p=f[1];l<c;++l)o=h,a=p,h=(f=u[l])[0],p=f[1],a<=r?p>r&&(h-o)*(r-a)>(p-a)*(t-o)&&++n:p<=r&&(h-o)*(r-a)<(p-a)*(t-o)&&--n;return n}(),e=y&&n,i=(l=it(l)).length;(e||i)&&(a.polygonStart(),e&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&Wo(l,u,n,o,a),a.polygonEnd());_=a,l=s=c=null}};function b(t,n){i(t,n)&&_.point(t,n)}function M(o,a){var u=i(o,a);if(s&&c.push([o,a]),m)f=o,h=a,p=u,m=!1,u&&(_.lineStart(),_.point(o,a));else if(u&&v)_.point(o,a);else{var l=[d=Math.max(ia,Math.min(ra,d)),g=Math.max(ia,Math.min(ra,g))],w=[o=Math.max(ia,Math.min(ra,o)),a=Math.max(ia,Math.min(ra,a))];!function(t,n,e,r,i,o){var a,u=t[0],l=t[1],s=0,c=1,f=n[0]-u,h=n[1]-l;if(a=e-u,f||!(a>0)){if(a/=f,f<0){if(a<s)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>s&&(s=a)}if(a=i-u,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>s&&(s=a)}else if(f>0){if(a<s)return;a<c&&(c=a)}if(a=r-l,h||!(a>0)){if(a/=h,h<0){if(a<s)return;a<c&&(c=a)}else if(h>0){if(a>c)return;a>s&&(s=a)}if(a=o-l,h||!(a<0)){if(a/=h,h<0){if(a>c)return;a>s&&(s=a)}else if(h>0){if(a<s)return;a<c&&(c=a)}return s>0&&(t[0]=u+s*f,t[1]=l+s*h),c<1&&(n[0]=u+c*f,n[1]=l+c*h),!0}}}}}(l,w,t,n,e,r)?u&&(_.lineStart(),_.point(o,a),y=!1):(v||(_.lineStart(),_.point(l[0],l[1])),_.point(w[0],w[1]),u||_.lineEnd(),y=!1)}d=o,g=a,v=u}return x}}var aa,ua,la,sa,ca=t=>t,fa=new Z,ha=new Z,pa={point:So,lineStart:So,lineEnd:So,polygonStart:function(){pa.lineStart=da,pa.lineEnd=ma},polygonEnd:function(){pa.lineStart=pa.lineEnd=pa.point=So,fa.add(po(ha)),ha=new Z},result:function(){var t=fa/2;return fa=new Z,t}};function da(){pa.point=ga}function ga(t,n){pa.point=va,aa=la=t,ua=sa=n}function va(t,n){ha.add(sa*t-la*n),la=t,sa=n}function ma(){va(aa,ua)}var ya=1/0,_a=ya,wa=-ya,xa=wa,ba={point:function(t,n){t<ya&&(ya=t);t>wa&&(wa=t);n<_a&&(_a=n);n>xa&&(xa=n)},lineStart:So,lineEnd:So,polygonStart:So,polygonEnd:So,result:function(){var t=[[ya,_a],[wa,xa]];return wa=xa=-(_a=ya=1/0),t}};var Ma,ka,Aa,Sa,Ta=0,Ea=0,Na=0,Ca=0,za=0,Da=0,Ya=0,Fa=0,La=0,ja={point:$a,lineStart:Ia,lineEnd:Oa,polygonStart:function(){ja.lineStart=qa,ja.lineEnd=Pa},polygonEnd:function(){ja.point=$a,ja.lineStart=Ia,ja.lineEnd=Oa},result:function(){var t=La?[Ya/La,Fa/La]:Da?[Ca/Da,za/Da]:Na?[Ta/Na,Ea/Na]:[NaN,NaN];return Ta=Ea=Na=Ca=za=Da=Ya=Fa=La=0,t}};function $a(t,n){Ta+=t,Ea+=n,++Na}function Ia(){ja.point=Ua}function Ua(t,n){ja.point=Ha,$a(Aa=t,Sa=n)}function Ha(t,n){var e=t-Aa,r=n-Sa,i=Mo(e*e+r*r);Ca+=i*(Aa+t)/2,za+=i*(Sa+n)/2,Da+=i,$a(Aa=t,Sa=n)}function Oa(){ja.point=$a}function qa(){ja.point=Va}function Pa(){Ba(Ma,ka)}function Va(t,n){ja.point=Ba,$a(Ma=Aa=t,ka=Sa=n)}function Ba(t,n){var e=t-Aa,r=n-Sa,i=Mo(e*e+r*r);Ca+=i*(Aa+t)/2,za+=i*(Sa+n)/2,Da+=i,Ya+=(i=Sa*t-Aa*n)*(Aa+t),Fa+=i*(Sa+n),La+=3*i,$a(Aa=t,Sa=n)}function Ra(t){this._context=t}Ra.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._context.moveTo(t,n),this._point=1;break;case 1:this._context.lineTo(t,n);break;default:this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,co)}},result:So};var Xa,Ga,Wa,Za,Ka,Ja=new Z,Qa={point:So,lineStart:function(){Qa.point=tu},lineEnd:function(){Xa&&nu(Ga,Wa),Qa.point=So},polygonStart:function(){Xa=!0},polygonEnd:function(){Xa=null},result:function(){var t=+Ja;return Ja=new Z,t}};function tu(t,n){Qa.point=nu,Ga=Za=t,Wa=Ka=n}function nu(t,n){Za-=t,Ka-=n,Ja.add(Mo(Za*Za+Ka*Ka)),Za=t,Ka=n}function eu(){this._string=[]}function ru(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function iu(t,n){var e,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Do(t,e(r))),r.result()}return o.area=function(t){return Do(t,e(pa)),pa.result()},o.measure=function(t){return Do(t,e(Qa)),Qa.result()},o.bounds=function(t){return Do(t,e(ba)),ba.result()},o.centroid=function(t){return Do(t,e(ja)),ja.result()},o.projection=function(n){return arguments.length?(e=null==n?(t=null,ca):(t=n).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(n=null,new eu):new Ra(n=t),"function"!=typeof i&&r.pointRadius(i),o):n},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(n)}function ou(t){return function(n){var e=new au;for(var r in t)e[r]=t[r];return e.stream=n,e}}function au(){}function uu(t,n,e){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),Do(e,t.stream(ba)),n(ba.result()),null!=r&&t.clipExtent(r),t}function lu(t,n,e){return uu(t,(function(e){var r=n[1][0]-n[0][0],i=n[1][1]-n[0][1],o=Math.min(r/(e[1][0]-e[0][0]),i/(e[1][1]-e[0][1])),a=+n[0][0]+(r-o*(e[1][0]+e[0][0]))/2,u=+n[0][1]+(i-o*(e[1][1]+e[0][1]))/2;t.scale(150*o).translate([a,u])}),e)}eu.prototype={_radius:4.5,_circle:ru(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._string.push("M",t,",",n),this._point=1;break;case 1:this._string.push("L",t,",",n);break;default:null==this._circle&&(this._circle=ru(this._radius)),this._string.push("M",t,",",n,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},au.prototype={constructor:au,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var su=mo(30*ho);function cu(t,n){return+n?function(t,n){function e(r,i,o,a,u,l,s,c,f,h,p,d,g,v){var m=s-r,y=c-i,_=m*m+y*y;if(_>4*n&&g--){var w=a+h,x=u+p,b=l+d,M=Mo(w*w+x*x+b*b),k=Ao(b/=M),A=po(po(b)-1)<ao||po(o-f)<ao?(o+f)/2:vo(x,w),S=t(A,k),T=S[0],E=S[1],N=T-r,C=E-i,z=y*N-m*C;(z*z/_>n||po((m*N+y*C)/_-.5)>.3||a*h+u*p+l*d<su)&&(e(r,i,o,a,u,l,T,E,A,w/=M,x/=M,b,g,v),v.point(T,E),e(T,E,A,w,x,b,s,c,f,h,p,d,g,v))}}return function(n){var r,i,o,a,u,l,s,c,f,h,p,d,g={point:v,lineStart:m,lineEnd:_,polygonStart:function(){n.polygonStart(),g.lineStart=w},polygonEnd:function(){n.polygonEnd(),g.lineStart=m}};function v(e,r){e=t(e,r),n.point(e[0],e[1])}function m(){c=NaN,g.point=y,n.lineStart()}function y(r,i){var o=Fo([r,i]),a=t(r,i);e(c,f,s,h,p,d,c=a[0],f=a[1],s=r,h=o[0],p=o[1],d=o[2],16,n),n.point(c,f)}function _(){g.point=v,n.lineEnd()}function w(){m(),g.point=x,g.lineEnd=b}function x(t,n){y(r=t,n),i=c,o=f,a=h,u=p,l=d,g.point=y}function b(){e(c,f,s,h,p,d,i,o,r,a,u,l,16,n),g.lineEnd=_,_()}return g}}(t,n):function(t){return ou({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}(t)}var fu=ou({point:function(t,n){this.stream.point(t*ho,n*ho)}});function hu(t,n,e,r,i,o){if(!o)return function(t,n,e,r,i){function o(o,a){return[n+t*(o*=r),e-t*(a*=i)]}return o.invert=function(o,a){return[(o-n)/t*r,(e-a)/t*i]},o}(t,n,e,r,i);var a=mo(o),u=xo(o),l=a*t,s=u*t,c=a/t,f=u/t,h=(u*e-a*n)/t,p=(u*n+a*e)/t;function d(t,o){return[l*(t*=r)-s*(o*=i)+n,e-s*t-l*o]}return d.invert=function(t,n){return[r*(c*t-f*n+h),i*(p-f*t-c*n)]},d}function pu(t){var n,e,r,i,o,a,u,l,s,c,f=150,h=480,p=250,d=0,g=0,v=0,m=0,y=0,_=0,w=1,x=1,b=null,M=na,k=null,A=ca,S=.5;function T(t){return l(t[0]*ho,t[1]*ho)}function E(t){return(t=l.invert(t[0],t[1]))&&[t[0]*fo,t[1]*fo]}function N(){var t=hu(f,0,0,w,x,_).apply(null,n(d,g)),r=hu(f,h-t[0],p-t[1],w,x,_);return e=function(t,n,e){return(t%=co)?n||e?Ho(Po(t),Vo(n,e)):Po(t):n||e?Vo(n,e):Oo}(v,m,y),u=Ho(n,r),l=Ho(e,u),a=cu(u,S),C()}function C(){return s=c=null,T}return T.stream=function(t){return s&&c===t?s:s=fu(function(t){return ou({point:function(n,e){var r=t(n,e);return this.stream.point(r[0],r[1])}})}(e)(M(a(A(c=t)))))},T.preclip=function(t){return arguments.length?(M=t,b=void 0,C()):M},T.postclip=function(t){return arguments.length?(A=t,k=r=i=o=null,C()):A},T.clipAngle=function(t){return arguments.length?(M=+t?ea(b=t*ho):(b=null,na),C()):b*fo},T.clipExtent=function(t){return arguments.length?(A=null==t?(k=r=i=o=null,ca):oa(k=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),C()):null==k?null:[[k,r],[i,o]]},T.scale=function(t){return arguments.length?(f=+t,N()):f},T.translate=function(t){return arguments.length?(h=+t[0],p=+t[1],N()):[h,p]},T.center=function(t){return arguments.length?(d=t[0]%360*ho,g=t[1]%360*ho,N()):[d*fo,g*fo]},T.rotate=function(t){return arguments.length?(v=t[0]%360*ho,m=t[1]%360*ho,y=t.length>2?t[2]%360*ho:0,N()):[v*fo,m*fo,y*fo]},T.angle=function(t){return arguments.length?(_=t%360*ho,N()):_*fo},T.reflectX=function(t){return arguments.length?(w=t?-1:1,N()):w<0},T.reflectY=function(t){return arguments.length?(x=t?-1:1,N()):x<0},T.precision=function(t){return arguments.length?(a=cu(u,S=t*t),C()):Mo(S)},T.fitExtent=function(t,n){return lu(T,t,n)},T.fitSize=function(t,n){return function(t,n,e){return lu(t,[[0,0],n],e)}(T,t,n)},T.fitWidth=function(t,n){return function(t,n,e){return uu(t,(function(e){var r=+n,i=r/(e[1][0]-e[0][0]),o=(r-i*(e[1][0]+e[0][0]))/2,a=-i*e[0][1];t.scale(150*i).translate([o,a])}),e)}(T,t,n)},T.fitHeight=function(t,n){return function(t,n,e){return uu(t,(function(e){var r=+n,i=r/(e[1][1]-e[0][1]),o=-i*e[0][0],a=(r-i*(e[1][1]+e[0][1]))/2;t.scale(150*i).translate([o,a])}),e)}(T,t,n)},function(){return n=t.apply(this,arguments),T.invert=n.invert&&E,N()}}function du(t,n){return[t,_o(ko((lo+n)/2))]}function gu(t){return ko((lo+t)/2)}function vu(t,n){var e=mo(t),r=t===n?xo(t):_o(e/mo(n))/_o(gu(n)/gu(t)),i=e*wo(gu(t),r)/r;if(!r)return du;function o(t,n){i>0?n<-lo+ao&&(n=-lo+ao):n>lo-ao&&(n=lo-ao);var e=i/wo(gu(n),r);return[e*xo(r*t),i-e*mo(r*t)]}return o.invert=function(t,n){var e=i-n,o=bo(r)*Mo(t*t+e*e),a=vo(t,po(e))*bo(e);return e*r<0&&(a-=uo*bo(t)*bo(e)),[a/r,2*go(wo(i/o,1/r))-lo]},o}function mu(){return(t=vu,n=0,e=uo/3,r=pu(t),i=r(n,e),i.parallels=function(t){return arguments.length?r(n=t[0]*ho,e=t[1]*ho):[n*fo,e*fo]},i).scale(109.5).parallels([30,30]);var t,n,e,r,i}function yu(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function _u(t,n){t instanceof Map?(t=[void 0,t],void 0===n&&(n=xu)):void 0===n&&(n=wu);for(var e,r,i,o,a,u=new ku(t),l=[u];e=l.pop();)if((i=n(e.data))&&(a=(i=Array.from(i)).length))for(e.children=i,o=a-1;o>=0;--o)l.push(r=i[o]=new ku(i[o])),r.parent=e,r.depth=e.depth+1;return u.eachBefore(Mu)}function wu(t){return t.children}function xu(t){return Array.isArray(t)?t[1]:null}function bu(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function Mu(t){var n=0;do{t.height=n}while((t=t.parent)&&t.height<++n)}function ku(t){this.data=t,this.depth=this.height=0,this.parent=null}function Au(t){for(var n,e,r=0,i=(t=function(t){for(var n,e,r=t.length;r;)e=Math.random()*r--|0,n=t[r],t[r]=t[e],t[e]=n;return t}(Array.from(t))).length,o=[];r<i;)n=t[r],e&&Eu(e,n)?++r:(e=Cu(o=Su(o,n)),r=0);return e}function Su(t,n){var e,r;if(Nu(n,t))return[n];for(e=0;e<t.length;++e)if(Tu(n,t[e])&&Nu(zu(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(r=e+1;r<t.length;++r)if(Tu(zu(t[e],t[r]),n)&&Tu(zu(t[e],n),t[r])&&Tu(zu(t[r],n),t[e])&&Nu(Du(t[e],t[r],n),t))return[t[e],t[r],n];throw new Error}function Tu(t,n){var e=t.r-n.r,r=n.x-t.x,i=n.y-t.y;return e<0||e*e<r*r+i*i}function Eu(t,n){var e=t.r-n.r+1e-9*Math.max(t.r,n.r,1),r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function Nu(t,n){for(var e=0;e<n.length;++e)if(!Eu(t,n[e]))return!1;return!0}function Cu(t){switch(t.length){case 1:return{x:(n=t[0]).x,y:n.y,r:n.r};case 2:return zu(t[0],t[1]);case 3:return Du(t[0],t[1],t[2])}var n}function zu(t,n){var e=t.x,r=t.y,i=t.r,o=n.x,a=n.y,u=n.r,l=o-e,s=a-r,c=u-i,f=Math.sqrt(l*l+s*s);return{x:(e+o+l/f*c)/2,y:(r+a+s/f*c)/2,r:(f+i+u)/2}}function Du(t,n,e){var r=t.x,i=t.y,o=t.r,a=n.x,u=n.y,l=n.r,s=e.x,c=e.y,f=e.r,h=r-a,p=r-s,d=i-u,g=i-c,v=l-o,m=f-o,y=r*r+i*i-o*o,_=y-a*a-u*u+l*l,w=y-s*s-c*c+f*f,x=p*d-h*g,b=(d*w-g*_)/(2*x)-r,M=(g*v-d*m)/x,k=(p*_-h*w)/(2*x)-i,A=(h*m-p*v)/x,S=M*M+A*A-1,T=2*(o+b*M+k*A),E=b*b+k*k-o*o,N=-(S?(T+Math.sqrt(T*T-4*S*E))/(2*S):E/T);return{x:r+b+M*N,y:i+k+A*N,r:N}}function Yu(t,n,e){var r,i,o,a,u=t.x-n.x,l=t.y-n.y,s=u*u+l*l;s?(i=n.r+e.r,i*=i,a=t.r+e.r,i>(a*=a)?(r=(s+a-i)/(2*s),o=Math.sqrt(Math.max(0,a/s-r*r)),e.x=t.x-r*u-o*l,e.y=t.y-r*l+o*u):(r=(s+i-a)/(2*s),o=Math.sqrt(Math.max(0,i/s-r*r)),e.x=n.x+r*u-o*l,e.y=n.y+r*l+o*u)):(e.x=n.x+e.r,e.y=n.y)}function Fu(t,n){var e=t.r+n.r-1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function Lu(t){var n=t._,e=t.next._,r=n.r+e.r,i=(n.x*e.r+e.x*n.r)/r,o=(n.y*e.r+e.y*n.r)/r;return i*i+o*o}function ju(t){this._=t,this.next=null,this.previous=null}function $u(t){if(!(i=(t=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,e,r,i,o,a,u,l,s,c,f;if((n=t[0]).x=0,n.y=0,!(i>1))return n.r;if(e=t[1],n.x=-e.r,e.x=n.r,e.y=0,!(i>2))return n.r+e.r;Yu(e,n,r=t[2]),n=new ju(n),e=new ju(e),r=new ju(r),n.next=r.previous=e,e.next=n.previous=r,r.next=e.previous=n;t:for(u=3;u<i;++u){Yu(n._,e._,r=t[u]),r=new ju(r),l=e.next,s=n.previous,c=e._.r,f=n._.r;do{if(c<=f){if(Fu(l._,r._)){e=l,n.next=e,e.previous=n,--u;continue t}c+=l._.r,l=l.next}else{if(Fu(s._,r._)){(n=s).next=e,e.previous=n,--u;continue t}f+=s._.r,s=s.previous}}while(l!==s.next);for(r.previous=n,r.next=e,n.next=e.previous=e=r,o=Lu(n);(r=r.next)!==e;)(a=Lu(r))<o&&(n=r,o=a);e=n.next}for(n=[e._],r=e;(r=r.next)!==e;)n.push(r._);for(r=Au(n),u=0;u<i;++u)(n=t[u]).x-=r.x,n.y-=r.y;return r.r}function Iu(t){return null==t?null:function(t){if("function"!=typeof t)throw new Error;return t}(t)}function Uu(){return 0}function Hu(t){return function(){return t}}function Ou(t){return Math.sqrt(t.value)}function qu(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function Pu(t,n){return function(e){if(r=e.children){var r,i,o,a=r.length,u=t(e)*n||0;if(u)for(i=0;i<a;++i)r[i].r+=u;if(o=$u(r),u)for(i=0;i<a;++i)r[i].r-=u;e.r=o+u}}}function Vu(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}function Bu(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}du.invert=function(t,n){return[t,2*go(yo(n))-lo]},ku.prototype=_u.prototype={constructor:ku,count:function(){return this.eachAfter(yu)},each:function(t,n){let e=-1;for(const r of this)t.call(n,r,++e,this);return this},eachAfter:function(t,n){for(var e,r,i,o=this,a=[o],u=[],l=-1;o=a.pop();)if(u.push(o),e=o.children)for(r=0,i=e.length;r<i;++r)a.push(e[r]);for(;o=u.pop();)t.call(n,o,++l,this);return this},eachBefore:function(t,n){for(var e,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(n,i,++a,this),e=i.children)for(r=e.length-1;r>=0;--r)o.push(e[r]);return this},find:function(t,n){let e=-1;for(const r of this)if(t.call(n,r,++e,this))return r},sum:function(t){return this.eachAfter((function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e}))},sort:function(t){return this.eachBefore((function(n){n.children&&n.children.sort(t)}))},path:function(t){for(var n=this,e=function(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;t=e.pop(),n=r.pop();for(;t===n;)i=t,t=e.pop(),n=r.pop();return i}(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(n){n.children||t.push(n)})),t},links:function(){var t=this,n=[];return t.each((function(e){e!==t&&n.push({source:e.parent,target:e})})),n},copy:function(){return _u(this).eachBefore(bu)},[Symbol.iterator]:function*(){var t,n,e,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,n=i.children)for(e=0,r=n.length;e<r;++e)o.push(n[e])}while(o.length)}};const Ru=Symbol("implicit");function Xu(){var t=new Map,n=[],e=[],r=Ru;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==Ru)return r;t.set(o,a=n.push(i))}return e[(a-1)%e.length]}return i.domain=function(e){if(!arguments.length)return n.slice();n=[],t=new Map;for(const r of e){const e=r+"";t.has(e)||t.set(e,n.push(r))}return i},i.range=function(t){return arguments.length?(e=Array.from(t),i):e.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Xu(n,e).unknown(r)},Bu.apply(i,arguments),i}function Gu(){var t,n,e=Xu().unknown(void 0),r=e.domain,i=e.range,o=0,a=1,u=!1,l=0,s=0,c=.5;function f(){var e=r().length,f=a<o,h=f?a:o,p=f?o:a;t=(p-h)/Math.max(1,e-l+2*s),u&&(t=Math.floor(t)),h+=(p-h-t*(e-l))*c,n=t*(1-l),u&&(h=Math.round(h),n=Math.round(n));var d=ot(e).map((function(n){return h+t*n}));return i(f?d.reverse():d)}return delete e.unknown,e.domain=function(t){return arguments.length?(r(t),f()):r()},e.range=function(t){return arguments.length?([o,a]=t,o=+o,a=+a,f()):[o,a]},e.rangeRound=function(t){return[o,a]=t,o=+o,a=+a,u=!0,f()},e.bandwidth=function(){return n},e.step=function(){return t},e.round=function(t){return arguments.length?(u=!!t,f()):u},e.padding=function(t){return arguments.length?(l=Math.min(1,s=+t),f()):l},e.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),f()):l},e.paddingOuter=function(t){return arguments.length?(s=+t,f()):s},e.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),f()):c},e.copy=function(){return Gu(r(),[o,a]).round(u).paddingInner(l).paddingOuter(s).align(c)},Bu.apply(f(),arguments)}function Wu(t){return+t}var Zu=[0,1];function Ku(t){return t}function Ju(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:function(t){return function(){return t}}(isNaN(n)?NaN:.5)}function Qu(t,n,e){var r=t[0],i=t[1],o=n[0],a=n[1];return i<r?(r=Ju(i,r),o=e(a,o)):(r=Ju(r,i),o=e(o,a)),function(t){return o(r(t))}}function tl(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++a<r;)i[a]=Ju(t[a],t[a+1]),o[a]=e(n[a],n[a+1]);return function(n){var e=G(t,n,1,r)-1;return o[e](i[e](n))}}function nl(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function el(){var t,n,e,r,i,o,a=Zu,u=Zu,l=Ue,s=Ku;function c(){var t,n,e,l=Math.min(a.length,u.length);return s!==Ku&&(t=a[0],n=a[l-1],t>n&&(e=t,t=n,n=e),s=function(e){return Math.max(t,Math.min(n,e))}),r=l>2?tl:Qu,i=o=null,f}function f(n){return isNaN(n=+n)?e:(i||(i=r(a.map(t),u,l)))(t(s(n)))}return f.invert=function(e){return s(n((o||(o=r(u,a.map(t),Fe)))(e)))},f.domain=function(t){return arguments.length?(a=Array.from(t,Wu),c()):a.slice()},f.range=function(t){return arguments.length?(u=Array.from(t),c()):u.slice()},f.rangeRound=function(t){return u=Array.from(t),l=He,c()},f.clamp=function(t){return arguments.length?(s=!!t||Ku,c()):s!==Ku},f.interpolate=function(t){return arguments.length?(l=t,c()):l},f.unknown=function(t){return arguments.length?(e=t,f):e},function(e,r){return t=e,n=r,c()}}function rl(){return el()(Ku,Ku)}function il(t,n,e,r){var i,o=nt(t,n,e);switch((r=Wi(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(n));return null!=r.precision||isNaN(i=function(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ri(n)/3)))-Ri(Math.abs(t)))}(o,a))||(r.precision=i),eo(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,Ri(n)-Ri(t))+1}(o,Math.max(Math.abs(t),Math.abs(n))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Ri(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return no(r)}function ol(t){var n=t.domain;return t.ticks=function(t){var e=n();return function(t,n,e){var r,i,o,a,u=-1;if(e=+e,(t=+t)==(n=+n)&&e>0)return[t];if((r=n<t)&&(i=t,t=n,n=i),0===(a=tt(t,n,e))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),n=Math.floor(n/a),o=new Array(i=Math.ceil(n-t+1));++u<i;)o[u]=(t+u)*a;else for(a=-a,t=Math.ceil(t*a),n=Math.floor(n*a),o=new Array(i=Math.ceil(n-t+1));++u<i;)o[u]=(t+u)/a;return r&&o.reverse(),o}(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var r=n();return il(r[0],r[r.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var r,i,o=n(),a=0,u=o.length-1,l=o[a],s=o[u],c=10;for(s<l&&(i=l,l=s,s=i,i=a,a=u,u=i);c-- >0;){if((i=tt(l,s,e))===r)return o[a]=l,o[u]=s,n(o);if(i>0)l=Math.floor(l/i)*i,s=Math.ceil(s/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,s=Math.floor(s*i)/i}r=i}return t},t}function al(){var t=rl();return t.copy=function(){return nl(t,al())},Bu.apply(t,arguments),ol(t)}function ul(){var t,n=0,e=1,r=1,i=[.5],o=[0,1];function a(n){return n<=n?o[G(i,n,0,r)]:t}function u(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*e-(t-r)*n)/(r+1);return a}return a.domain=function(t){return arguments.length?([n,e]=t,n=+n,e=+e,u()):[n,e]},a.range=function(t){return arguments.length?(r=(o=Array.from(t)).length-1,u()):o.slice()},a.invertExtent=function(t){var a=o.indexOf(t);return a<0?[NaN,NaN]:a<1?[n,i[0]]:a>=r?[i[r-1],e]:[i[a-1],i[a]]},a.unknown=function(n){return arguments.length?(t=n,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return ul().domain([n,e]).range(o).unknown(t)},Bu.apply(ol(a),arguments)}var ll=new Date,sl=new Date;function cl(t,n,e,r){function i(n){return t(n=0===arguments.length?new Date:new Date(+n)),n}return i.floor=function(n){return t(n=new Date(+n)),n},i.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},i.round=function(t){var n=i(t),e=i.ceil(t);return t-n<e-t?n:e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,o){var a,u=[];if(e=i.ceil(e),o=null==o?1:Math.floor(o),!(e<r&&o>0))return u;do{u.push(a=new Date(+e)),n(e,o),t(e)}while(a<e&&e<r);return u},i.filter=function(e){return cl((function(n){if(n>=n)for(;t(n),!e(n);)n.setTime(n-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;n(t,-1),!e(t););else for(;--r>=0;)for(;n(t,1),!e(t););}))},e&&(i.count=function(n,r){return ll.setTime(+n),sl.setTime(+r),t(ll),t(sl),Math.floor(e(ll,sl))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(n){return r(n)%t==0}:function(n){return i.count(0,n)%t==0}):i:null}),i}var fl=cl((function(){}),(function(t,n){t.setTime(+t+n)}),(function(t,n){return n-t}));fl.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?cl((function(n){n.setTime(Math.floor(n/t)*t)}),(function(n,e){n.setTime(+n+e*t)}),(function(n,e){return(e-n)/t})):fl:null};var hl=1e3,pl=6e4,dl=36e5,gl=864e5,vl=6048e5,ml=cl((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,n){t.setTime(+t+n*hl)}),(function(t,n){return(n-t)/hl}),(function(t){return t.getUTCSeconds()})),yl=cl((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*hl)}),(function(t,n){t.setTime(+t+n*pl)}),(function(t,n){return(n-t)/pl}),(function(t){return t.getMinutes()})),_l=cl((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*hl-t.getMinutes()*pl)}),(function(t,n){t.setTime(+t+n*dl)}),(function(t,n){return(n-t)/dl}),(function(t){return t.getHours()})),wl=cl((t=>t.setHours(0,0,0,0)),((t,n)=>t.setDate(t.getDate()+n)),((t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*pl)/gl),(t=>t.getDate()-1));function xl(t){return cl((function(n){n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)}),(function(t,n){t.setDate(t.getDate()+7*n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*pl)/vl}))}var bl=xl(0),Ml=xl(1),kl=(xl(2),xl(3),xl(4)),Al=(xl(5),xl(6),cl((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,n){t.setMonth(t.getMonth()+n)}),(function(t,n){return n.getMonth()-t.getMonth()+12*(n.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}))),Sl=cl((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n)}),(function(t,n){return n.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Sl.every=function(t){return isFinite(t=Math.floor(t))&&t>0?cl((function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)}),(function(n,e){n.setFullYear(n.getFullYear()+e*t)})):null};var Tl=cl((function(t){t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+n)}),(function(t,n){return(n-t)/gl}),(function(t){return t.getUTCDate()-1}));function El(t){return cl((function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+7*n)}),(function(t,n){return(n-t)/vl}))}var Nl=El(0),Cl=El(1),zl=(El(2),El(3),El(4)),Dl=(El(5),El(6),cl((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)}),(function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));function Yl(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Fl(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ll(t,n,e){return{y:t,m:n,d:e,H:0,M:0,S:0,L:0}}Dl.every=function(t){return isFinite(t=Math.floor(t))&&t>0?cl((function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)}),(function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)})):null};var jl,$l,Il,Ul={"-":"",_:" ",0:"0"},Hl=/^\s*\d+/,Ol=/^%/,ql=/[\\^$*+?|[\]().{}]/g;function Pl(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function Vl(t){return t.replace(ql,"\\$&")}function Bl(t){return new RegExp("^(?:"+t.map(Vl).join("|")+")","i")}function Rl(t){return new Map(t.map(((t,n)=>[t.toLowerCase(),n])))}function Xl(t,n,e){var r=Hl.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function Gl(t,n,e){var r=Hl.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function Wl(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function Zl(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function Kl(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function Jl(t,n,e){var r=Hl.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function Ql(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function ts(t,n,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function ns(t,n,e){var r=Hl.exec(n.slice(e,e+1));return r?(t.q=3*r[0]-3,e+r[0].length):-1}function es(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function rs(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function is(t,n,e){var r=Hl.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function os(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function as(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function us(t,n,e){var r=Hl.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function ls(t,n,e){var r=Hl.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function ss(t,n,e){var r=Hl.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function cs(t,n,e){var r=Ol.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function fs(t,n,e){var r=Hl.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function hs(t,n,e){var r=Hl.exec(n.slice(e));return r?(t.s=+r[0],e+r[0].length):-1}function ps(t,n){return Pl(t.getDate(),n,2)}function ds(t,n){return Pl(t.getHours(),n,2)}function gs(t,n){return Pl(t.getHours()%12||12,n,2)}function vs(t,n){return Pl(1+wl.count(Sl(t),t),n,3)}function ms(t,n){return Pl(t.getMilliseconds(),n,3)}function ys(t,n){return ms(t,n)+"000"}function _s(t,n){return Pl(t.getMonth()+1,n,2)}function ws(t,n){return Pl(t.getMinutes(),n,2)}function xs(t,n){return Pl(t.getSeconds(),n,2)}function bs(t){var n=t.getDay();return 0===n?7:n}function Ms(t,n){return Pl(bl.count(Sl(t)-1,t),n,2)}function ks(t){var n=t.getDay();return n>=4||0===n?kl(t):kl.ceil(t)}function As(t,n){return t=ks(t),Pl(kl.count(Sl(t),t)+(4===Sl(t).getDay()),n,2)}function Ss(t){return t.getDay()}function Ts(t,n){return Pl(Ml.count(Sl(t)-1,t),n,2)}function Es(t,n){return Pl(t.getFullYear()%100,n,2)}function Ns(t,n){return Pl((t=ks(t)).getFullYear()%100,n,2)}function Cs(t,n){return Pl(t.getFullYear()%1e4,n,4)}function zs(t,n){var e=t.getDay();return Pl((t=e>=4||0===e?kl(t):kl.ceil(t)).getFullYear()%1e4,n,4)}function Ds(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+Pl(n/60|0,"0",2)+Pl(n%60,"0",2)}function Ys(t,n){return Pl(t.getUTCDate(),n,2)}function Fs(t,n){return Pl(t.getUTCHours(),n,2)}function Ls(t,n){return Pl(t.getUTCHours()%12||12,n,2)}function js(t,n){return Pl(1+Tl.count(Dl(t),t),n,3)}function $s(t,n){return Pl(t.getUTCMilliseconds(),n,3)}function Is(t,n){return $s(t,n)+"000"}function Us(t,n){return Pl(t.getUTCMonth()+1,n,2)}function Hs(t,n){return Pl(t.getUTCMinutes(),n,2)}function Os(t,n){return Pl(t.getUTCSeconds(),n,2)}function qs(t){var n=t.getUTCDay();return 0===n?7:n}function Ps(t,n){return Pl(Nl.count(Dl(t)-1,t),n,2)}function Vs(t){var n=t.getUTCDay();return n>=4||0===n?zl(t):zl.ceil(t)}function Bs(t,n){return t=Vs(t),Pl(zl.count(Dl(t),t)+(4===Dl(t).getUTCDay()),n,2)}function Rs(t){return t.getUTCDay()}function Xs(t,n){return Pl(Cl.count(Dl(t)-1,t),n,2)}function Gs(t,n){return Pl(t.getUTCFullYear()%100,n,2)}function Ws(t,n){return Pl((t=Vs(t)).getUTCFullYear()%100,n,2)}function Zs(t,n){return Pl(t.getUTCFullYear()%1e4,n,4)}function Ks(t,n){var e=t.getUTCDay();return Pl((t=e>=4||0===e?zl(t):zl.ceil(t)).getUTCFullYear()%1e4,n,4)}function Js(){return"+0000"}function Qs(){return"%"}function tc(t){return+t}function nc(t){return Math.floor(+t/1e3)}!function(t){jl=function(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,u=t.months,l=t.shortMonths,s=Bl(i),c=Rl(i),f=Bl(o),h=Rl(o),p=Bl(a),d=Rl(a),g=Bl(u),v=Rl(u),m=Bl(l),y=Rl(l),_={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:ps,e:ps,f:ys,g:Ns,G:zs,H:ds,I:gs,j:vs,L:ms,m:_s,M:ws,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:tc,s:nc,S:xs,u:bs,U:Ms,V:As,w:Ss,W:Ts,x:null,X:null,y:Es,Y:Cs,Z:Ds,"%":Qs},w={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:Ys,e:Ys,f:Is,g:Ws,G:Ks,H:Fs,I:Ls,j:js,L:$s,m:Us,M:Hs,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:tc,s:nc,S:Os,u:qs,U:Ps,V:Bs,w:Rs,W:Xs,x:null,X:null,y:Gs,Y:Zs,Z:Js,"%":Qs},x={a:function(t,n,e){var r=p.exec(n.slice(e));return r?(t.w=d.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(t,n,e){var r=f.exec(n.slice(e));return r?(t.w=h.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(t,n,e){var r=m.exec(n.slice(e));return r?(t.m=y.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(t,n,e){var r=g.exec(n.slice(e));return r?(t.m=v.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(t,e,r){return k(t,n,e,r)},d:rs,e:rs,f:ss,g:Ql,G:Jl,H:os,I:os,j:is,L:ls,m:es,M:as,p:function(t,n,e){var r=s.exec(n.slice(e));return r?(t.p=c.get(r[0].toLowerCase()),e+r[0].length):-1},q:ns,Q:fs,s:hs,S:us,u:Gl,U:Wl,V:Zl,w:Xl,W:Kl,x:function(t,n,r){return k(t,e,n,r)},X:function(t,n,e){return k(t,r,n,e)},y:Ql,Y:Jl,Z:ts,"%":cs};function b(t,n){return function(e){var r,i,o,a=[],u=-1,l=0,s=t.length;for(e instanceof Date||(e=new Date(+e));++u<s;)37===t.charCodeAt(u)&&(a.push(t.slice(l,u)),null!=(i=Ul[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(o=n[r])&&(r=o(e,i)),a.push(r),l=u+1);return a.push(t.slice(l,u)),a.join("")}}function M(t,n){return function(e){var r,i,o=Ll(1900,void 0,1);if(k(o,t,e+="",0)!=e.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(n&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Fl(Ll(o.y,0,1))).getUTCDay(),r=i>4||0===i?Cl.ceil(r):Cl(r),r=Tl.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Yl(Ll(o.y,0,1))).getDay(),r=i>4||0===i?Ml.ceil(r):Ml(r),r=wl.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Fl(Ll(o.y,0,1)).getUTCDay():Yl(Ll(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Fl(o)):Yl(o)}}function k(t,n,e,r){for(var i,o,a=0,u=n.length,l=e.length;a<u;){if(r>=l)return-1;if(37===(i=n.charCodeAt(a++))){if(i=n.charAt(a++),!(o=x[i in Ul?n.charAt(a++):i])||(r=o(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}return _.x=b(e,_),_.X=b(r,_),_.c=b(n,_),w.x=b(e,w),w.X=b(r,w),w.c=b(n,w),{format:function(t){var n=b(t+="",_);return n.toString=function(){return t},n},parse:function(t){var n=M(t+="",!1);return n.toString=function(){return t},n},utcFormat:function(t){var n=b(t+="",w);return n.toString=function(){return t},n},utcParse:function(t){var n=M(t+="",!0);return n.toString=function(){return t},n}}}(t),$l=jl.format,Il=jl.parse,jl.utcFormat,jl.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ec=1e3,rc=6e4,ic=36e5,oc=864e5,ac=2592e6,uc=31536e6;function lc(t){return new Date(t)}function sc(t){return t instanceof Date?+t:+new Date(+t)}function cc(t,n,e,r,i,o,a,u,l){var s=rl(),c=s.invert,f=s.domain,h=l(".%L"),p=l(":%S"),d=l("%I:%M"),g=l("%I %p"),v=l("%a %d"),m=l("%b %d"),y=l("%B"),_=l("%Y"),w=[[a,1,ec],[a,5,5e3],[a,15,15e3],[a,30,3e4],[o,1,rc],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,ic],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,oc],[r,2,1728e5],[e,1,6048e5],[n,1,ac],[n,3,7776e6],[t,1,uc]];function x(u){return(a(u)<u?h:o(u)<u?p:i(u)<u?d:r(u)<u?g:n(u)<u?e(u)<u?v:m:t(u)<u?y:_)(u)}function b(n,e,r){if(null==n&&(n=10),"number"==typeof n){var i,o=Math.abs(r-e)/n,a=X((function(t){return t[2]})).right(w,o);return a===w.length?(i=nt(e/uc,r/uc,n),n=t):a?(i=(a=w[o/w[a-1][2]<w[a][2]/o?a-1:a])[1],n=a[0]):(i=Math.max(nt(e,r,n),1),n=u),n.every(i)}return n}return s.invert=function(t){return new Date(c(t))},s.domain=function(t){return arguments.length?f(Array.from(t,sc)):f().map(lc)},s.ticks=function(t){var n,e=f(),r=e[0],i=e[e.length-1],o=i<r;return o&&(n=r,r=i,i=n),n=(n=b(t,r,i))?n.range(r,i+1):[],o?n.reverse():n},s.tickFormat=function(t,n){return null==n?x:l(n)},s.nice=function(t){var n=f();return(t=b(t,n[0],n[n.length-1]))?f(function(t,n){var e,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(e=r,r=i,i=e,e=o,o=a,a=e),t[r]=n.floor(o),t[i]=n.ceil(a),t}(n,t)):s},s.copy=function(){return nl(s,cc(t,n,e,r,i,o,a,u,l))},s}function fc(t){return function(){return t}}function hc(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function pc(t){this._context=t}function dc(t){return new pc(t)}function gc(t){return t[0]}function vc(t){return t[1]}function mc(t,n){var e=fc(!0),r=null,i=dc,o=null;function a(a){var u,l,s,c=(a=hc(a)).length,f=!1;for(null==r&&(o=i(s=zi())),u=0;u<=c;++u)!(u<c&&e(l=a[u],u,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(l,u,a),+n(l,u,a));if(s)return o=null,s+""||null}return t="function"==typeof t?t:void 0===t?gc:fc(t),n="function"==typeof n?n:void 0===n?vc:fc(n),a.x=function(n){return arguments.length?(t="function"==typeof n?n:fc(+n),a):t},a.y=function(t){return arguments.length?(n="function"==typeof t?t:fc(+t),a):n},a.defined=function(t){return arguments.length?(e="function"==typeof t?t:fc(!!t),a):e},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a}function yc(t,n,e){var r=null,i=fc(!0),o=null,a=dc,u=null;function l(l){var s,c,f,h,p,d=(l=hc(l)).length,g=!1,v=new Array(d),m=new Array(d);for(null==o&&(u=a(p=zi())),s=0;s<=d;++s){if(!(s<d&&i(h=l[s],s,l))===g)if(g=!g)c=s,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),f=s-1;f>=c;--f)u.point(v[f],m[f]);u.lineEnd(),u.areaEnd()}g&&(v[s]=+t(h,s,l),m[s]=+n(h,s,l),u.point(r?+r(h,s,l):v[s],e?+e(h,s,l):m[s]))}if(p)return u=null,p+""||null}function s(){return mc().defined(i).curve(a).context(o)}return t="function"==typeof t?t:void 0===t?gc:fc(+t),n="function"==typeof n?n:fc(void 0===n?0:+n),e="function"==typeof e?e:void 0===e?vc:fc(+e),l.x=function(n){return arguments.length?(t="function"==typeof n?n:fc(+n),r=null,l):t},l.x0=function(n){return arguments.length?(t="function"==typeof n?n:fc(+n),l):t},l.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:fc(+t),l):r},l.y=function(t){return arguments.length?(n="function"==typeof t?t:fc(+t),e=null,l):n},l.y0=function(t){return arguments.length?(n="function"==typeof t?t:fc(+t),l):n},l.y1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:fc(+t),l):e},l.lineX0=l.lineY0=function(){return s().x(t).y(n)},l.lineY1=function(){return s().x(t).y(e)},l.lineX1=function(){return s().x(r).y(n)},l.defined=function(t){return arguments.length?(i="function"==typeof t?t:fc(!!t),l):i},l.curve=function(t){return arguments.length?(a=t,null!=o&&(u=a(o)),l):a},l.context=function(t){return arguments.length?(null==t?o=u=null:u=a(o=t),l):o},l}function _c(t,n){this._context=t,this._t=n}function wc(t){return new _c(t,0)}function xc(t,n){if((i=t.length)>1)for(var e,r,i,o=1,a=t[n[0]],u=a.length;o<i;++o)for(r=a,a=t[n[o]],e=0;e<u;++e)a[e][1]+=a[e][0]=isNaN(r[e][1])?r[e][0]:r[e][1]}function bc(t){for(var n=t.length,e=new Array(n);--n>=0;)e[n]=n;return e}function Mc(t,n){return t[n]}function kc(t){const n=[];return n.key=t,n}function Ac(){var t=fc([]),n=bc,e=xc,r=Mc;function i(i){var o,a,u=Array.from(t.apply(this,arguments),kc),l=u.length,s=-1;for(const t of i)for(o=0,++s;o<l;++o)(u[o][s]=[0,+r(t,u[o].key,s,i)]).data=t;for(o=0,a=hc(n(u));o<l;++o)u[a[o]].index=o;return e(u,a),u}return i.keys=function(n){return arguments.length?(t="function"==typeof n?n:fc(Array.from(n)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:fc(+t),i):r},i.order=function(t){return arguments.length?(n=null==t?bc:"function"==typeof t?t:fc(Array.from(t)),i):n},i.offset=function(t){return arguments.length?(e=null==t?xc:t,i):e},i}pc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}},_c.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var e=this._x*(1-this._t)+t*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,n)}}this._x=t,this._y=n}};var Sc=t=>()=>t;function Tc(t,{sourceEvent:n,target:e,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Ec(t,n,e){this.k=t,this.x=n,this.y=e}Ec.prototype={constructor:Ec,scale:function(t){return 1===t?this:new Ec(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new Ec(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Nc=new Ec(1,0,0);function Cc(t){t.stopImmediatePropagation()}function zc(t){t.preventDefault(),t.stopImmediatePropagation()}function Dc(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Yc(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Fc(){return this.__zoom||Nc}function Lc(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function jc(){return navigator.maxTouchPoints||"ontouchstart"in this}function $c(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],a=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function Ic(){var t,n,e,r=Dc,i=Yc,o=$c,a=Lc,u=jc,l=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],c=250,f=Ke,h=yt("start","zoom","end"),p=500,d=0,g=10;function v(t){t.property("__zoom",Fc).on("wheel.zoom",M).on("mousedown.zoom",k).on("dblclick.zoom",A).filter(u).on("touchstart.zoom",S).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(t,n){return(n=Math.max(l[0],Math.min(l[1],n)))===t.k?t:new Ec(n,t.x,t.y)}function y(t,n,e){var r=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return r===t.x&&i===t.y?t:new Ec(t.k,r,i)}function _(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,n,e,r){t.on("start.zoom",(function(){x(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,o=arguments,a=x(t,o).event(r),u=i.apply(t,o),l=null==e?_(u):"function"==typeof e?e.apply(t,o):e,s=Math.max(u[1][0]-u[0][0],u[1][1]-u[0][1]),c=t.__zoom,h="function"==typeof n?n.apply(t,o):n,p=f(c.invert(l).concat(s/c.k),h.invert(l).concat(s/h.k));return function(t){if(1===t)t=h;else{var n=p(t),e=s/n[2];t=new Ec(e,l[0]-n[0]*e,l[1]-n[1]*e)}a.zoom(null,t)}}))}function x(t,n,e){return!e&&t.__zooming||new b(t,n)}function b(t,n){this.that=t,this.args=n,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,n),this.taps=0}function M(t,...n){if(r.apply(this,arguments)){var e=x(this,n).event(t),i=this.__zoom,u=Math.max(l[0],Math.min(l[1],i.k*Math.pow(2,a.apply(this,arguments)))),c=In(t);if(e.wheel)e.mouse[0][0]===c[0]&&e.mouse[0][1]===c[1]||(e.mouse[1]=i.invert(e.mouse[0]=c)),clearTimeout(e.wheel);else{if(i.k===u)return;e.mouse=[c,i.invert(c)],wr(this),e.start()}zc(t),e.wheel=setTimeout(f,150),e.zoom("mouse",o(y(m(i,u),e.mouse[0],e.mouse[1]),e.extent,s))}function f(){e.wheel=null,e.end()}}function k(t,...n){if(!e&&r.apply(this,arguments)){var i=x(this,n,!0).event(t),a=$n(t.view).on("mousemove.zoom",h,!0).on("mouseup.zoom",p,!0),u=In(t,l),l=t.currentTarget,c=t.clientX,f=t.clientY;qn(t.view),Cc(t),i.mouse=[u,this.__zoom.invert(u)],wr(this),i.start()}function h(t){if(zc(t),!i.moved){var n=t.clientX-c,e=t.clientY-f;i.moved=n*n+e*e>d}i.event(t).zoom("mouse",o(y(i.that.__zoom,i.mouse[0]=In(t,l),i.mouse[1]),i.extent,s))}function p(t){a.on("mousemove.zoom mouseup.zoom",null),Pn(t.view,i.moved),zc(t),i.event(t).end()}}function A(t,...n){if(r.apply(this,arguments)){var e=this.__zoom,a=In(t.changedTouches?t.changedTouches[0]:t,this),u=e.invert(a),l=e.k*(t.shiftKey?.5:2),f=o(y(m(e,l),a,u),i.apply(this,n),s);zc(t),c>0?$n(this).transition().duration(c).call(w,f,a,t):$n(this).call(v.transform,f,a,t)}}function S(e,...i){if(r.apply(this,arguments)){var o,a,u,l,s=e.touches,c=s.length,f=x(this,i,e.changedTouches.length===c).event(e);for(Cc(e),a=0;a<c;++a)l=[l=In(u=s[a],this),this.__zoom.invert(l),u.identifier],f.touch0?f.touch1||f.touch0[2]===l[2]||(f.touch1=l,f.taps=0):(f.touch0=l,o=!0,f.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(f.taps<2&&(n=l[0],t=setTimeout((function(){t=null}),p)),wr(this),f.start())}}function T(t,...n){if(this.__zooming){var e,r,i,a,u=x(this,n).event(t),l=t.changedTouches,c=l.length;for(zc(t),e=0;e<c;++e)i=In(r=l[e],this),u.touch0&&u.touch0[2]===r.identifier?u.touch0[0]=i:u.touch1&&u.touch1[2]===r.identifier&&(u.touch1[0]=i);if(r=u.that.__zoom,u.touch1){var f=u.touch0[0],h=u.touch0[1],p=u.touch1[0],d=u.touch1[1],g=(g=p[0]-f[0])*g+(g=p[1]-f[1])*g,v=(v=d[0]-h[0])*v+(v=d[1]-h[1])*v;r=m(r,Math.sqrt(g/v)),i=[(f[0]+p[0])/2,(f[1]+p[1])/2],a=[(h[0]+d[0])/2,(h[1]+d[1])/2]}else{if(!u.touch0)return;i=u.touch0[0],a=u.touch0[1]}u.zoom("touch",o(y(r,i,a),u.extent,s))}}function E(t,...r){if(this.__zooming){var i,o,a=x(this,r).event(t),u=t.changedTouches,l=u.length;for(Cc(t),e&&clearTimeout(e),e=setTimeout((function(){e=null}),p),i=0;i<l;++i)o=u[i],a.touch0&&a.touch0[2]===o.identifier?delete a.touch0:a.touch1&&a.touch1[2]===o.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(o=In(o,this),Math.hypot(n[0]-o[0],n[1]-o[1])<g)){var s=$n(this).on("dblclick.zoom");s&&s.apply(this,arguments)}}}return v.transform=function(t,n,e,r){var i=t.selection?t.selection():t;i.property("__zoom",Fc),t!==i?w(t,n,e,r):i.interrupt().each((function(){x(this,arguments).event(r).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()}))},v.scaleBy=function(t,n,e,r){v.scaleTo(t,(function(){var t=this.__zoom.k,e="function"==typeof n?n.apply(this,arguments):n;return t*e}),e,r)},v.scaleTo=function(t,n,e,r){v.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,a=null==e?_(t):"function"==typeof e?e.apply(this,arguments):e,u=r.invert(a),l="function"==typeof n?n.apply(this,arguments):n;return o(y(m(r,l),a,u),t,s)}),e,r)},v.translateBy=function(t,n,e,r){v.transform(t,(function(){return o(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof e?e.apply(this,arguments):e),i.apply(this,arguments),s)}),null,r)},v.translateTo=function(t,n,e,r,a){v.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,u=null==r?_(t):"function"==typeof r?r.apply(this,arguments):r;return o(Nc.translate(u[0],u[1]).scale(a.k).translate("function"==typeof n?-n.apply(this,arguments):-n,"function"==typeof e?-e.apply(this,arguments):-e),t,s)}),r,a)},b.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var n=$n(this.that).datum();h.call(t,this.that,new Tc(t,{sourceEvent:this.sourceEvent,target:v,type:t,transform:this.that.__zoom,dispatch:h}),n)}},v.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:Sc(+t),v):a},v.filter=function(t){return arguments.length?(r="function"==typeof t?t:Sc(!!t),v):r},v.touchable=function(t){return arguments.length?(u="function"==typeof t?t:Sc(!!t),v):u},v.extent=function(t){return arguments.length?(i="function"==typeof t?t:Sc([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),v):i},v.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],v):[l[0],l[1]]},v.translateExtent=function(t){return arguments.length?(s[0][0]=+t[0][0],s[1][0]=+t[1][0],s[0][1]=+t[0][1],s[1][1]=+t[1][1],v):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},v.constrain=function(t){return arguments.length?(o=t,v):o},v.duration=function(t){return arguments.length?(c=+t,v):c},v.interpolate=function(t){return arguments.length?(f=t,v):f},v.on=function(){var t=h.on.apply(h,arguments);return t===h?v:t},v.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,v):Math.sqrt(d)},v.tapDistance=function(t){return arguments.length?(g=+t,v):g},v}function Uc(n){let e;return{c(){e=c("div"),e.innerHTML='<h1 class="text-center"><img class="logo" src="logo_bee.jpg"/>\n        Project DataViz Lyon 1 (2020-2021)\n        <img class="logo" src="logo_bee.jpg"/></h1> \n    <div class="row mt-3"><div class="col-3"></div> \n        <div class="col-6"><p class="presentation">In this project, we wanted to show the consequences of climate change on the evolution of European shymenoptera (different bee species of the genus Bombus). \n                <br/> \n                <br/><u>Data:</u> \n                <br/>The data that we represent come from the research site <a href="http://www.atlashymenoptera.net/page.aspx?id=169" target="_blank">atlashymenoptera.net</a>\n                     and consist of 79 different species of hymenoptera which evolved on the European continent between 1800 and 2013. Thanks to the 79 files collected, we were able to collect and collate data from all species and we have represented them on different charts and maps.</p> \n            <br/> \n            <p class="presentation"><u>Contents:</u> \n            <br/>On this project, we set up four visualizations, showing the geographical distribution of the data, the evolution over time and also a study by country on the proliferation of different bee species.</p> \n            <p class="presentation text-muted"><u>Contributors</u> : HOSSAIN Shajjad, BAMBA William, GLASS Philippe, HAMAT Abdoulaye.\n                <br/>(Masters 2nd years students).</p>\n            Data Source : <a href="http://www.atlashymenoptera.net/page.aspx?id=169" target="_blank">atlashymenoptera.net</a> \n            \n            <p class="presentation"></p> \n\n                <img src="img_home.png" alt="photo" title="Bombus species" width="900"/></div> \n        <div class="col-3"></div></div>',v(e,"class","mt-5")},m(t,n){u(t,e,n)},p:t,i:t,o:t,d(t){t&&l(e)}}}function Hc(t,n,e){let{ripos:r}=n,i=[];fetch("data_sources.json").then((t=>t.json()));return b((async()=>{for(var t=await r.speciesData.then((t=>t)),n=[],e=0;e<t.length;e++)for(var o=t[e],a=o.name,u=0;u<o.imgs.length&&i.length<2;u++){var l={src:"http://www.atlashymenoptera.net/"+o.imgs[u],name:a};n.push(l),n.length>=6&&i.length<2&&(i.push(n),n=[])}})),t.$$set=t=>{"ripos"in t&&e(0,r=t.ripos)},[r]}function Oc(t,n,e){const r=t.slice();return r[35]=n[e],r[37]=e,r}function qc(t,n,e){const r=t.slice();return r[38]=n[e],r[37]=e,r}function Pc(t,n,e){const r=t.slice();return r[13]=n[e],r[37]=e,r}function Vc(n){let e,r,i;return{c(){e=f("stop"),v(e,"offset",r=n[37]/n[8].length*100+"%"),v(e,"stop-color",i=n[13])},m(t,n){u(t,e,n)},p:t,d(t){t&&l(e)}}}function Bc(t){let n;return{c(){n=c("div"),n.innerHTML='<div class="card-body"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>',v(n,"class","text-center card")},m(t,e){u(t,n,e)},d(t){t&&l(n)}}}function Rc(t){let n,e,r,i,o,s,f=t[7].specie+"";return{c(){n=h("Specie: "),e=h(f),r=p(),i=c("a"),o=h("Show In Google Map"),v(i,"href",s="https://www.google.com/maps/@"+t[7].lat+","+t[7].long+",11z"),v(i,"target","_blank")},m(t,l){u(t,n,l),u(t,e,l),u(t,r,l),u(t,i,l),a(i,o)},p(t,n){128&n[0]&&f!==(f=t[7].specie+"")&&m(e,f),128&n[0]&&s!==(s="https://www.google.com/maps/@"+t[7].lat+","+t[7].long+",11z")&&v(i,"href",s)},d(t){t&&l(n),t&&l(e),t&&l(r),t&&l(i)}}}function Xc(t){let n,e,r=t[35].subspecies,i=[];for(let n=0;n<r.length;n+=1)i[n]=Gc(qc(t,r,n));return{c(){n=c("ul");for(let t=0;t<i.length;t+=1)i[t].c();e=p(),v(n,"class","list-group list-group-flush")},m(t,r){u(t,n,r);for(let t=0;t<i.length;t+=1)i[t].m(n,null);a(n,e)},p(t,o){if(3106&o[0]){let a;for(r=t[35].subspecies,a=0;a<r.length;a+=1){const u=qc(t,r,a);i[a]?i[a].p(u,o):(i[a]=Gc(u),i[a].c(),i[a].m(n,e))}for(;a<i.length;a+=1)i[a].d(1);i.length=r.length}},d(t){t&&l(n),s(i,t)}}}function Gc(t){let n,e,r,i,o,s,f,d,y,_,w,x,b=t[38]+"",M=t[10](t[38],t[1],!1)+"";return{c(){n=c("li"),e=c("span"),r=c("input"),s=p(),f=h(b),d=p(),y=c("span"),_=h(M),v(r,"class","form-check-input me-1"),v(r,"type","checkbox"),r.checked=i=!0,r.value=o=t[38],v(y,"class","badge text-dark"),v(n,"class","list-group-item d-flex justify-content-between align-items-center")},m(i,o){u(i,n,o),a(n,e),a(e,r),a(e,s),a(e,f),a(n,d),a(n,y),a(y,_),w||(x=g(r,"input",t[11]),w=!0)},p(t,n){32&n[0]&&o!==(o=t[38])&&(r.value=o),32&n[0]&&b!==(b=t[38]+"")&&m(f,b),34&n[0]&&M!==(M=t[10](t[38],t[1],!1)+"")&&m(_,M)},d(t){t&&l(n),w=!1,x()}}}function Wc(t){let n,e,r,i,o,s,f,y,w,x,b=t[35].name+"",M=t[10](t[35].name,t[1],!0)+"";function k(){return t[17](t[37],t[35])}let A=t[6].parentIndex==t[37]&&Xc(t);return{c(){n=c("li"),e=h(b),r=p(),i=c("span"),o=h(M),f=p(),A&&A.c(),y=d(),v(i,"class","badge bg-primary rounded-pill"),_(n,"cursor","pointer"),v(n,"class",s="list-group-item d-flex justify-content-between align-items-center "+(t[6].parentIndex==t[37]?" active ":""))},m(t,l){u(t,n,l),a(n,e),a(n,r),a(n,i),a(i,o),u(t,f,l),A&&A.m(t,l),u(t,y,l),w||(x=g(n,"click",k),w=!0)},p(r,i){t=r,32&i[0]&&b!==(b=t[35].name+"")&&m(e,b),34&i[0]&&M!==(M=t[10](t[35].name,t[1],!0)+"")&&m(o,M),64&i[0]&&s!==(s="list-group-item d-flex justify-content-between align-items-center "+(t[6].parentIndex==t[37]?" active ":""))&&v(n,"class",s),t[6].parentIndex==t[37]?A?A.p(t,i):(A=Xc(t),A.c(),A.m(y.parentNode,y)):A&&(A.d(1),A=null)},d(t){t&&l(n),t&&l(f),A&&A.d(t),t&&l(y),w=!1,x()}}}function Zc(n){let e,i,o,d,_,w,x,b,M,k,A,S,T,E,N,C,z,D,Y,F,L,j,$,I,U,H,O,q,P,V,B,R,X,G,W,Z,K,J,Q,tt,nt,et,rt,it,ot,at,ut,lt,st,ct,ft,ht,pt,dt=n[2][n[1]]+"",gt=(isFinite(n[3])?n[3]:"NaN")+"",vt=(isFinite(n[4])?n[4]:"NaN")+"",mt=(n[7].long||0)+"",yt=(n[7].lat||0)+"",_t=(n[7].freq||0)+"",wt=n[8],xt=[];for(let t=0;t<wt.length;t+=1)xt[t]=Vc(Pc(n,wt,t));let bt=n[0]&&Bc(),Mt=n[7].long&&n[7].lat&&Rc(n),kt=n[5],At=[];for(let t=0;t<kt.length;t+=1)At[t]=Wc(Oc(n,kt,t));return{c(){e=c("div"),i=c("h1"),i.innerHTML='<img class="logo" src="logo_bee.jpg"/>Geographic distribution of bees<img class="logo" src="logo_bee.jpg"/>',o=p(),d=c("div"),d.innerHTML='<div class="col-2"></div> \n        <div class="col-8"><p class="text-muted">In this visualization we show the geographic distribution of different species and sub species of bees. You can filter them by year using the slider and the species listed on the right by selection them. The map is also an interactive one, you can zoom and drage it to navigate in it.</p></div>',_=p(),w=c("div"),x=c("div"),b=c("div"),M=c("div"),k=c("label"),A=h("Year: "),S=h(dt),T=p(),E=c("input"),C=p(),z=c("div"),D=c("div"),Y=c("div"),F=h("min: "),L=h(gt),j=p(),$=c("div"),I=p(),U=c("div"),H=h("max: "),O=h(vt),q=p(),P=f("svg"),V=f("defs"),B=f("linearGradient");for(let t=0;t<xt.length;t+=1)xt[t].c();R=f("rect"),X=p(),bt&&bt.c(),G=p(),W=c("div"),Z=c("div"),K=c("div"),J=h("Longitude: "),Q=h(mt),tt=h(" Latitude: "),nt=h(yt),et=h(" Frequency: "),rt=h(_t),it=p(),ot=c("span"),Mt&&Mt.c(),at=p(),ut=c("div"),lt=c("div"),lt.innerHTML='<div id="app" class="mt-2 text-center border"></div>',st=p(),ct=c("div"),ft=c("ul");for(let t=0;t<At.length;t+=1)At[t].c();v(i,"class","text-center mt-4 mb-4"),v(d,"class","row"),v(k,"for","year-range"),v(E,"type","range"),v(E,"min","0"),v(E,"max",N=n[2].length-1),v(E,"class","form-range"),v(E,"id","year-range"),v(M,"class","col-8"),v(Y,"class","col-3 text-left"),v($,"class","col-6"),v(U,"class","col-3 text-right"),v(D,"class","row"),v(B,"id","gradient"),v(R,"x","0"),v(R,"y","0"),v(R,"width","600"),v(R,"height","100"),v(R,"fill","url(#gradient)"),v(R,"stroke","black"),v(R,"stroke-width","1"),v(P,"width","90%"),v(P,"height","25"),v(z,"class","col-4"),v(b,"class","row"),v(x,"class","card-body"),v(w,"class","card"),v(K,"class","card-body"),v(Z,"class","card"),v(W,"class","row"),v(lt,"class","col-9"),v(ft,"class","list-group"),v(ct,"class","col-3 mt-2"),v(ut,"class","row m-1")},m(t,r){u(t,e,r),a(e,i),a(e,o),a(e,d),a(e,_),a(e,w),a(w,x),a(x,b),a(b,M),a(M,k),a(k,A),a(k,S),a(M,T),a(M,E),y(E,n[1]),a(b,C),a(b,z),a(z,D),a(D,Y),a(Y,F),a(Y,L),a(D,j),a(D,$),a(D,I),a(D,U),a(U,H),a(U,O),a(z,q),a(z,P),a(P,V),a(V,B);for(let t=0;t<xt.length;t+=1)xt[t].m(B,null);a(P,R),a(e,X),bt&&bt.m(e,null),a(e,G),a(e,W),a(W,Z),a(Z,K),a(K,J),a(K,Q),a(K,tt),a(K,nt),a(K,et),a(K,rt),a(K,it),a(K,ot),Mt&&Mt.m(ot,null),a(e,at),a(e,ut),a(ut,lt),a(ut,st),a(ut,ct),a(ct,ft);for(let t=0;t<At.length;t+=1)At[t].m(ft,null);ht||(pt=[g(E,"change",n[15]),g(E,"input",n[15]),g(E,"input",n[16])],ht=!0)},p(t,n){if(6&n[0]&&dt!==(dt=t[2][t[1]]+"")&&m(S,dt),4&n[0]&&N!==(N=t[2].length-1)&&v(E,"max",N),2&n[0]&&y(E,t[1]),8&n[0]&&gt!==(gt=(isFinite(t[3])?t[3]:"NaN")+"")&&m(L,gt),16&n[0]&&vt!==(vt=(isFinite(t[4])?t[4]:"NaN")+"")&&m(O,vt),256&n[0]){let e;for(wt=t[8],e=0;e<wt.length;e+=1){const r=Pc(t,wt,e);xt[e]?xt[e].p(r,n):(xt[e]=Vc(r),xt[e].c(),xt[e].m(B,null))}for(;e<xt.length;e+=1)xt[e].d(1);xt.length=wt.length}if(t[0]?bt||(bt=Bc(),bt.c(),bt.m(e,G)):bt&&(bt.d(1),bt=null),128&n[0]&&mt!==(mt=(t[7].long||0)+"")&&m(Q,mt),128&n[0]&&yt!==(yt=(t[7].lat||0)+"")&&m(nt,yt),128&n[0]&&_t!==(_t=(t[7].freq||0)+"")&&m(rt,_t),t[7].long&&t[7].lat?Mt?Mt.p(t,n):(Mt=Rc(t),Mt.c(),Mt.m(ot,null)):Mt&&(Mt.d(1),Mt=null),7266&n[0]){let e;for(kt=t[5],e=0;e<kt.length;e+=1){const r=Oc(t,kt,e);At[e]?At[e].p(r,n):(At[e]=Wc(r),At[e].c(),At[e].m(ft,null))}for(;e<At.length;e+=1)At[e].d(1);At.length=kt.length}},i:t,o:t,d(t){t&&l(e),s(xt,t),bt&&bt.d(),Mt&&Mt.d(),s(At,t),ht=!1,r(pt)}}}function Kc(t){return t.split(" ")[2]}function Jc(t){return t.split(" ")[0]+" "+t.split(" ")[1]}function Qc(t,n,e){const r=tf(n,e.Year);t[r]||(t[r]=0),t[r]+=parseInt(e.Frequency)}function tf(t,n){return t+"-"+n}function nf(t,n,e){let r,i,o,{ripos:a}=n,u=window.innerHeight-100,l=9.454071,s=52.279229,c=1200,f=C(l,s,c),h=iu().projection(f),p=!0,d=0,g=[],v=[],m=[],y=["rgba(82, 190, 128, 0.3)","rgba(34, 153, 84, 0.3)","rgba(25, 111, 61 , 0.3)","rgba(220, 20, 20, 0.3)"],_=ul().range(y),w=[],x=[],M={},k=[],A={parentIndex:0,subSpecie:[]},S={},T={},E=al().domain([10,130]).range([5,15]);function N(){r.selectAll("circle").remove(),r.selectAll("text").remove();let t=v.filter((t=>{if(t.Year!=g[d])return!1;const n=M[parseInt(t.SpecieId)];return Jc(n.name)==k[A.parentIndex].name&&A.subSpecie.includes(Kc(n.name))})),n=t.map((t=>parseInt(t.Frequency))).filter(((t,n,e)=>e.indexOf(t)===n)).sort(((t,n)=>parseInt(n.Frequency)-parseInt(t.Frequency)));e(3,i=Math.min(...n)),e(4,o=Math.max(...n)),_.domain([i,o]),E.domain([i,o]),r.selectAll("circle").data(t).enter().append("circle").attr("cx",(t=>f([t.Longitude,t.Latitude])[0])).attr("cy",(t=>f([t.Longitude,t.Latitude])[1])).attr("r",(t=>E(t.Frequency))).style("fill",(t=>_(parseInt(t.Frequency)))).on("click",((t,n)=>{e(7,T.long=n.Longitude,T),e(7,T.lat=n.Latitude,T),e(7,T.freq=n.Frequency,T);const r=M[parseInt(n.SpecieId)];e(7,T.specie=Kc(r.name),T)})).attr("stroke-width",2).attr("stroke","black"),c<200||r.selectAll("text").data(w).enter().append("text").text((t=>c<800?t.country:t.name)).attr("x",(t=>f([t.longitude,t.latitude])[0])).attr("y",(t=>f([t.longitude,t.latitude])[1])).style("fill","#000")}function C(t,n,e){return mu().center([t,n]).scale(e)}function z(t,n){e(6,A.parentIndex=t,A),e(6,A.subSpecie=n,A),N()}b((async()=>{x=await a.euGeoJson.then((t=>t)),v=await a.bombusFreq.then((t=>t)),m=await a.speciesData.then((t=>t)),w=await a.countriesPos.then((t=>t)),M=function(t){let n={};for(let e=0;e<t.length;e++){const r=t[e];n[r.name]||(n[r.id]=r)}return n}(m),e(5,k=function(t){let n={};for(let e=0;e<t.length;e++){const r=t[e],i=Jc(r.name);n[i]||(n[i]={name:i,subspecies:[]}),n[i].subspecies.push(Kc(r.name))}return Object.values(n)}(m)),e(6,A.subSpecie=k[A.parentIndex].subspecies,A),S=function(t,n){let e={};for(let r=0;r<t.length;r++){const i=t[r],o=n[parseInt(i.SpecieId)],a=Jc(o.name),u=Kc(o.name);Qc(e,a,i),Qc(e,u,i)}return e}(v,M),async function(){u=window.innerHeight-100,$n("#app").selectAll("svg").remove();let t=function(t){let n,e,r,i=iu().projection(f),o=function(){var t,n,e,r,i=Rn,o=Xn,a=Gn,u=Wn,l={},s=yt("start","drag","end"),c=0,f=0;function h(t){t.on("mousedown.drag",p).filter(u).on("touchstart.drag",v).on("touchmove.drag",m).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(a,u){if(!r&&i.call(this,a,u)){var l=_(this,o.call(this,a,u),a,u,"mouse");l&&($n(a.view).on("mousemove.drag",d,!0).on("mouseup.drag",g,!0),qn(a.view),Hn(a),e=!1,t=a.clientX,n=a.clientY,l("start",a))}}function d(r){if(On(r),!e){var i=r.clientX-t,o=r.clientY-n;e=i*i+o*o>f}l.mouse("drag",r)}function g(t){$n(t.view).on("mousemove.drag mouseup.drag",null),Pn(t.view,e),On(t),l.mouse("end",t)}function v(t,n){if(i.call(this,t,n)){var e,r,a=t.changedTouches,u=o.call(this,t,n),l=a.length;for(e=0;e<l;++e)(r=_(this,u,t,n,a[e].identifier,a[e]))&&(Hn(t),r("start",t,a[e]))}}function m(t){var n,e,r=t.changedTouches,i=r.length;for(n=0;n<i;++n)(e=l[r[n].identifier])&&(On(t),e("drag",t,r[n]))}function y(t){var n,e,i=t.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),n=0;n<o;++n)(e=l[i[n].identifier])&&(Hn(t),e("end",t,i[n]))}function _(t,n,e,r,i,o){var u,f,p,d=s.copy(),g=In(o||e,n);if(null!=(p=a.call(t,new Bn("beforestart",{sourceEvent:e,target:h,identifier:i,active:c,x:g[0],y:g[1],dx:0,dy:0,dispatch:d}),r)))return u=p.x-g[0]||0,f=p.y-g[1]||0,function e(o,a,s){var v,m=g;switch(o){case"start":l[i]=e,v=c++;break;case"end":delete l[i],--c;case"drag":g=In(s||a,n),v=c}d.call(o,t,new Bn(o,{sourceEvent:a,subject:p,target:h,identifier:i,active:v,x:g[0]+u,y:g[1]+f,dx:g[0]-m[0],dy:g[1]-m[1],dispatch:d}),r)}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:Vn(!!t),h):i},h.container=function(t){return arguments.length?(o="function"==typeof t?t:Vn(t),h):o},h.subject=function(t){return arguments.length?(a="function"==typeof t?t:Vn(t),h):a},h.touchable=function(t){return arguments.length?(u="function"==typeof t?t:Vn(!!t),h):u},h.on=function(){var t=s.on.apply(s,arguments);return t===s?h:t},h.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,h):Math.sqrt(f)},h}().on("start",(t=>{let n=f.invert([t.x,t.y]);e=n[0],r=n[1]})).on("drag",a).on("end",a);function a(n){let o=f.invert([n.x,n.y]),a=o[0]-e,u=o[1]-r;0==a&&0==u||(l-=a,s-=u,f=C(l,s,c),i=iu().projection(f),$n(t).selectAll("path").attr("d",i),N())}function u(e){let r=e.transform.k-n;r>0?c*=1.1:r<0&&(c*=.9),f=C(l,s,c),i=iu().projection(f),n=e.transform.k,$n(t).selectAll("path").attr("d",i),N()}return{zoom:Ic().on("start",(t=>n=t.transform.k)).on("zoom",u).on("end",u),drag:o}}("#app");r=$n("#app").append("svg").attr("width","100%").attr("height",u).attr("cursor","pointer").attr("draggable",!0).call(t.drag).call(t.zoom),r.selectAll("path").data(x.features).enter().append("path").attr("d",h).attr("class",(t=>t.properties.name)).style("fill","#FDFEFE").style("stroke","black"),e(2,g=v.map((t=>parseInt(t.Year))).filter(((t,n,e)=>e.indexOf(t)===n)).sort()),N(),e(0,p=!1)}()}));return t.$$set=t=>{"ripos"in t&&e(14,a=t.ripos)},[p,d,g,i,o,k,A,T,y,N,function(t,n,e=!0){let r=Jc(t);e||(r=t);const i=tf(r,g[n]);return S[i]||0},function(t){const n=t.target,r=n.value;n.checked?A.subSpecie.push(r):e(6,A.subSpecie=A.subSpecie.filter((t=>t!=r)),A),N()},z,_,a,function(){var t;t=this.value,d=""===t?null:+t,e(1,d)},()=>N(),(t,n)=>z(t,n.subspecies)]}function ef(n){let e,r,i,o,a;return{c(){e=c("h1"),e.innerHTML='<img class="logo" src="logo_bee.jpg"/> Stack Area chart of the evolution of bees<img class="logo" src="logo_bee.jpg"/>',r=p(),i=c("div"),i.innerHTML='<p style="text-align: left;">This  stacked area chart represents the evolution of the Bombus and its species throught time . We can zoom to a specific period for more insight.</p>',o=p(),a=c("div"),v(e,"class","text-center mt-4 mb-4"),_(e,"font-family","Raleway"),v(i,"id","3"),v(a,"id","my_dataviz")},m(t,n){u(t,e,n),u(t,r,n),u(t,i,n),u(t,o,n),u(t,a,n)},p:t,i:t,o:t,d(t){t&&l(e),t&&l(r),t&&l(i),t&&l(o),t&&l(a)}}}function rf(t){return t.split(" ")[2]}function of(t,n,e){let r,i,o,a,u,{ripos:l}=n,s=50,c=20,f=50,h=50,p=.95*document.body.clientWidth,d=.8*window.innerHeight,g=[],v=[],m=0,y=0,_=[],w={},x=[],M=[],k={parentIndex:0};function A(t){let n=!1;return x[k.parentIndex].ids.forEach((e=>{t==e.toString()&&(n=!0)})),n}return b((async()=>{_=await l.speciesData.then((t=>t)),v=await l.bombusFreq.then((t=>t)),w=function(t){let n={};for(let e=0;e<t.length;e++){const r=t[e];n[r.name]||(n[r.id]=r)}return n}(_),x=function(t){let n={};for(let r=0;r<t.length;r++){const i=t[r],o=(e=i.name).split(" ")[0]+" "+e.split(" ")[1];n[o]||(n[o]={name:o,subspecies:[],Parent_id:r,ids:[]}),n[o].subspecies.push(rf(i.name)),n[o].ids.push(i.id)}var e;return Object.values(n)}(_),async function(){g=v.map((t=>parseInt(t.Year))).filter(((t,n,e)=>e.indexOf(t)===n)),function(t,n){console.log(x.length);let e=0;n.forEach((t=>{let n={date:0};n.date=t;for(let e=0;e<x.length;e++)k.parentIndex=e,n[x[e].name]=v.filter((n=>n.Year==t.toString()&&A(n.SpecieId))).length;M[e]=n,e+=1}))}(0,g),m=rt(v,(function(t){return t.Year})),y=et(v,(function(t){return t.Year})),r=$n("#my_dataviz").append("svg").attr("width",p+s+c).attr("height",d+f+h).append("g").attr("transform","translate("+s+","+f+")");let t=[],n=0;x.forEach((e=>{t[n]=e.name,n++})),console.log(t);let e=Xu().domain(t).range(["rgba(192, 57, 43, 0.5)","rgba(136, 78, 160, 0.5)","rgba(36, 113, 163, 0.5)","rgba(23, 165, 137, 0.5)","rgba(30, 132, 73, 0.5)","rgba(241, 196, 15, 0.5)","rgba(131, 145, 146, 0.5)"]),l=Ac().keys(t)(M);i=al().domain(W(M,(function(t){return t.date}))).range([0,p]),a=r.append("g").attr("transform","translate(0,"+d+")").call(gt(i).ticks(5)),r.append("text").attr("text-anchor","end").attr("x",p).attr("y",d+40).text("Time (year)"),r.append("text").attr("text-anchor","end").attr("x",0).attr("y",-20).text("Frequency").attr("text-anchor","start"),u=al().domain([0,12e3]).range([d,0]),r.append("g").call(vt(u).ticks(5));r.append("defs").append("svg:clipPath").attr("id","clip").append("svg:rect").attr("width",p).attr("height",d).attr("x",0).attr("y",0);let _,w=Ai().extent([[0,0],[p,d]]).on("end",T),b=r.append("g").attr("clip-path","url(#clip)");function S(){_=null}function T({selection:t}){let n=t;if(n)i.domain([i.invert(n[0]),i.invert(n[1])]),b.select(".brush").call(w.move,null);else{if(!_)return _=setTimeout(S,350);i.domain([parseInt(m),parseInt(y)])}a.transition().duration(1e3).call(gt(i)),b.selectAll("path").transition().duration(1e3).attr("d",o)}o=yc().x((function(t){return i(t.data.date)})).y0((function(t){return u(t[0])})).y1((function(t){return u(t[1])})),b.selectAll("mylayers").data(l).enter().append("path").attr("class",(function(t){return"myArea "+t.key})).style("fill",(function(t){return e(t.key)})).attr("d",o),b.append("g").attr("class","brush").call(w);var E=30;r.selectAll("myrect").data(t).enter().append("rect").attr("x",50).attr("y",(function(t,n){return 10+n*(E+5)})).attr("width",E).attr("height",E).style("fill",(function(t){return e(t)})),r.selectAll("mylabels").data(t).enter().append("text").attr("x",50+1.2*E).attr("y",(function(t,n){return 10+n*(E+5)+E/2})).style("fill",(function(t){return e(t)})).text((function(t){return t})).attr("text-anchor","left").style("alignment-baseline","middle")}()})),t.$$set=t=>{"ripos"in t&&e(0,l=t.ripos)},[l]}function af(t,n,e){const r=t.slice();return r[28]=n[e],r[30]=e,r}function uf(t){let n,e,r,i,o,s,f=t[28].name+"";function d(){return t[4](t[30])}return{c(){n=c("li"),e=h(f),r=p(),_(n,"cursor","pointer"),v(n,"class",i="list-group-item d-flex justify-content-between align-items-center "+(t[1].parentIndex==t[30]?" active ":""))},m(t,i){u(t,n,i),a(n,e),a(n,r),o||(s=g(n,"click",d),o=!0)},p(r,o){t=r,1&o&&f!==(f=t[28].name+"")&&m(e,f),2&o&&i!==(i="list-group-item d-flex justify-content-between align-items-center "+(t[1].parentIndex==t[30]?" active ":""))&&v(n,"class",i)},d(t){t&&l(n),o=!1,s()}}}function lf(n){let e,r,i,o,f,h,d,g,m,y,w,x=n[0],b=[];for(let t=0;t<x.length;t+=1)b[t]=uf(af(n,x,t));return{c(){e=c("h1"),e.innerHTML='<img class="logo" src="logo_bee.jpg"/>Area chart of the evolution of bees<img class="logo" src="logo_bee.jpg"/>',r=p(),i=c("div"),o=c("div"),o.innerHTML='<div id="my_dataviz"></div>',f=p(),h=c("div"),d=c("ul");for(let t=0;t<b.length;t+=1)b[t].c();g=p(),m=c("div"),m.innerHTML='<p style="text-align: left;">This chart represents the evolution of the Bombus and its species throught time . We can zoom to a specific period for more insight</p>',y=p(),w=c("div"),w.innerHTML='<p style="text-align: center;">*Select an area to zoom and Double click to reset</p>',v(e,"class","text-center mt-4 mb-4"),_(e,"font-family","Raleway"),v(o,"class","col-9"),v(d,"class","list-group"),v(h,"class","col-3 mt-2"),v(i,"class","row m-1"),v(m,"id","3"),v(w,"id","2")},m(t,n){u(t,e,n),u(t,r,n),u(t,i,n),a(i,o),a(i,f),a(i,h),a(h,d);for(let t=0;t<b.length;t+=1)b[t].m(d,null);u(t,g,n),u(t,m,n),u(t,y,n),u(t,w,n)},p(t,[n]){if(7&n){let e;for(x=t[0],e=0;e<x.length;e+=1){const r=af(t,x,e);b[e]?b[e].p(r,n):(b[e]=uf(r),b[e].c(),b[e].m(d,null))}for(;e<b.length;e+=1)b[e].d(1);b.length=x.length}},i:t,o:t,d(t){t&&l(e),t&&l(r),t&&l(i),s(b,t),t&&l(g),t&&l(m),t&&l(y),t&&l(w)}}}function sf(t){return t.split(" ")[2]}function cf(t,n,e){let r,i,o,a,u,l,{ripos:s}=n,c=50,f=20,h=50,p=50,d=.7*document.body.clientWidth,g=.6*window.innerHeight,v=[],m=[],y=0,_=0,w=[],x=[],M=[],k={},A=[],S={parentIndex:0};function T(t,n){if(-1==S.parentIndex)E(t,n);else{n.forEach((n=>w[n]=t.filter((t=>t.Year==n.toString()&&function(t){let n=!1;return A[S.parentIndex].ids.forEach((e=>{t==e.toString()&&(n=!0)})),n}(t.SpecieId))).length));let e=w.map((function(t,n){return{date:n,value:t}})),r=0;e.forEach((t=>{null!=t&&(x[r]=t,r++)}))}r.domain(W(x,(function(t){return Il("%Y")(t.date)}))),u.domain([0,et(x,(function(t){return+t.value}))]),a.transition().call(gt(r)),l.transition().call(vt(u)),o.select(".myArea").transition().attr("d",i)}function E(t,n){n.forEach((n=>w[n]=t.filter((t=>t.Year==n.toString())).length));let e=w.map((function(t,n){return{date:n,value:t}})),r=0;e.forEach((t=>{null!=t&&(x[r]=t,r++)})),console.log(x)}function N(t){S.parentIndex==t&&(t=-1),e(1,S.parentIndex=t,S),T(m,v)}b((async()=>{M=await s.speciesData.then((t=>t)),m=await s.bombusFreq.then((t=>t)),k=function(t){let n={};for(let e=0;e<t.length;e++){const r=t[e];n[r.name]||(n[r.id]=r)}return n}(M),e(0,A=function(t){let n={};for(let r=0;r<t.length;r++){const i=t[r],o=(e=i.name).split(" ")[0]+" "+e.split(" ")[1];n[o]||(n[o]={name:o,subspecies:[],Parent_id:r,ids:[]}),n[o].subspecies.push(sf(i.name)),n[o].ids.push(i.id)}var e;return Object.values(n)}(M)),A.forEach((t=>{console.log(t.ids),"42"in t.ids&&console.log("no "+t.Parent_id.toString())})),console.log(A),async function(){v=m.map((t=>parseInt(t.Year))).filter(((t,n,e)=>e.indexOf(t)===n)),E(m,v),y=rt(m,(function(t){return t.Year})),_=et(m,(function(t){return t.Year}));let t=$n("#my_dataviz").append("svg").attr("width",d+c+f).attr("height",g+h+p).append("g").attr("transform","translate("+c+","+h+")");r=function(){return Bu.apply(cc(Sl,Al,bl,wl,_l,yl,ml,fl,$l).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}().domain(W(x,(function(t){return Il("%Y")(t.date)}))).range([0,d]),a=t.append("g").attr("transform","translate(0,"+g+")").call(gt(r)),u=al().domain([0,et(x,(function(t){return+t.value}))]).range([g,0]),l=t.append("g").call(vt(u));let n,e=Ai().extent([[0,0],[d,g]]).on("end",w);function s(){n=null}function w({selection:t}){let u=t;if(u)r.domain([r.invert(u[0]),r.invert(u[1])]),o.select(".brush").call(e.move,null);else{if(!n)return n=setTimeout(s,350);r.domain([parseInt(y),parseInt(_)])}a.transition().duration(1e3).call(gt(r)),o.select(".myArea").transition().duration(1e3).attr("d",i)}o=t.append("g").attr("clip-path","url(#clip2)"),i=yc().x((function(t){return r(Il("%Y")(t.date))})).y0(u(0)).y1((function(t){return u(t.value)})),t.append("text").attr("text-anchor","end").attr("x",0).attr("y",-20).text("Frequency").attr("text-anchor","start"),t.append("text").attr("text-anchor","end").attr("x",d).attr("y",g+40).text("Time (year)"),t.append("linearGradient").attr("id","areachart-gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("x2",0).attr("y1",u(rt(x,(t=>Il("%Y")(t.date))))).attr("y2",u(et(x,(t=>Il("%Y")(t.date))))).selectAll("stop").data([{offset:"0%",color:"#bae399"},{offset:"100%",color:"#93dd5a"}]).enter().append("stop").attr("offset",(t=>t.offset)).attr("stop-color",(t=>t.color)),o.append("path").datum(x).attr("class","myArea").style("fill","url(#areachart-gradient)").style("opacity","0.6").attr("d",i),o.append("g").attr("class","brush").call(e),t.on("dblclick",(function(){r.domain(W(x,(function(t){return Il("%Y")(t.date)}))),u.domain([0,et(x,(function(t){return+t.value}))]),a.transition().call(gt(r)),l.transition().call(vt(u)),o.select(".myArea").transition().attr("d",i)}))}()}));return t.$$set=t=>{"ripos"in t&&e(3,s=t.ripos)},[A,S,N,s,t=>N(t)]}function ff(n){let e,r,i,o,s,f,d,y,w,x,b,M,k,A,S,T,E,N,C,z,D,Y;return{c(){e=c("div"),r=c("h2"),r.innerHTML='<img src="logo_bee.jpg" class="img-fluid" width="50px"/> Evolution by year <img src="logo_bee.jpg" class="img-fluid" width="50px"/>',i=p(),o=c("div"),o.innerHTML='<div class="row"><div class="col-2"></div> \n        <div class="col-8"><p class="text-muted">This view represents the evolution by year of the bee populations, both globally and in each country.<br/>\n            You can use the country filter below to remove or add countries to the visualization.\n            You can also use the slider on the right to lengthen or shorten the time range.<br/> \n            <u>Please note</u> :\n            Since the amount of data is less for the years before 1970, this graph cannot show a realistic end-to-end evolution over a range beyond 50 years.<br/>\n            It is however interesting to note the countries which appear or disappear from the map if one uses a display over a long period.</p></div> \n        <div class="col-2"><span class="text_small svelte-vxhaig">Source :\n                <br/>    multi-color chart :    <a href="https://www.datavis.fr" target="_blank">datavis.fr</a> \n                <br/>    data : <a href="http://www.atlashymenoptera.net/page.aspx?id=169" target="_blank">atlashymenoptera.net</a></span></div></div>',s=p(),f=c("span"),f.textContent="   Selected Countries :",d=p(),y=c("input"),w=p(),x=c("input"),b=p(),M=c("span"),M.textContent="   Selected time range :       ",k=p(),A=c("input"),S=p(),T=c("span"),E=h(" "),N=h(n[2]),C=p(),z=c("div"),z.innerHTML='<div id="bubble_selector"></div> \n    <div id="histo_chart"></div>',v(r,"class","text-center mt-4 mb-4"),v(f,"class","explain_text svelte-vxhaig"),v(f,"id","label_min_year_slider"),v(y,"id","unselect_all"),v(y,"class","bt_selector svelte-vxhaig"),v(y,"type","button"),y.value="Unselect all",v(x,"id","select_all"),v(x,"class","bt_selector svelte-vxhaig"),v(x,"type","button"),x.value="Select all",v(M,"class","explain_text svelte-vxhaig"),v(M,"id","label_min_year_slider"),_(A,"width","30%"),v(A,"id","min_year_slider"),v(A,"type","range"),v(A,"step","1"),v(A,"min",n[0]),v(A,"max",n[1]),A.value=n[2],v(A,"class","form-range"),v(T,"id","label_min_year_slider2")},m(t,l){u(t,e,l),a(e,r),a(e,i),a(e,o),a(e,s),a(e,f),a(e,d),a(e,y),a(e,w),a(e,x),a(e,b),a(e,M),a(e,k),a(e,A),a(e,S),a(e,T),a(T,E),a(T,N),u(t,C,l),u(t,z,l),D||(Y=g(A,"input",n[5]),D=!0)},p(t,n){1&n[0]&&v(A,"min",t[0]),2&n[0]&&v(A,"max",t[1]),4&n[0]&&(A.value=t[2]),4&n[0]&&m(N,t[2])},i:t,o:t,d(t){t&&l(e),t&&l(C),t&&l(z),D=!1,Y()}}}let hf=20;function pf(t,n,e,r){for(var i={},o=0,a=0;a<e.length;a++){i[s=e[a]]=0}for(var u=0;u<t.length;u++){var l=t[u],s=l[n];e.indexOf(s)>=0&&(i[s]=i[s]+1*l.Frequency,o+=1*l.Frequency)}var c=r*o;for(a=0;a<e.length;a++){i[s=e[a]]<c&&(i.hasOwnProperty("Other")||(i.Other=0),i.Other=i.Other+1*i[s],delete i[s])}return i}function df(t,n,e){let r,i,o,a,u,{ripos:l}=n,s=70,c=20,f=30,h=60,p=document.body.clientWidth-s-c-20,d=500-f-h,g=100+.1*(window.innerHeight-40),v=function(t,n,e){return mu().center([t,n]).scale(e)}(9.454071,52.279229,1200),m=(iu().projection(v),[]),y=[],_=[],w=[],x=[],M=[],k=1050,A=["#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081","#ffcccc","#ffb3b3","#ff9999","#ff8080","#ff6666","#ff4d4d","#ff3333","#ff1a1a","#ff0000","#e60000","#cc0000","#b30000","#990000","#800000","#660000"],S=[],T=[],E={},N={},C=[],z=!0,D=1800,Y=2013,F=1980,L=[],j={};var $=function(){var t=null,n=1,e=1,r=Uu;function i(i){return i.x=n/2,i.y=e/2,t?i.eachBefore(qu(t)).eachAfter(Pu(r,.5)).eachBefore(Vu(1)):i.eachBefore(qu(Ou)).eachAfter(Pu(Uu,1)).eachAfter(Pu(r,i.r/Math.min(n,e))).eachBefore(Vu(Math.min(n,e)/(2*i.r))),i}return i.radius=function(n){return arguments.length?(t=Iu(n),i):t},i.size=function(t){return arguments.length?(n=+t[0],e=+t[1],i):[n,e]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:Hu(+t),i):r},i}().size([p,d]).padding(1.5);$n("body").append("div").attr("class","tooltip").style("opacity",0);function I(){var t=document.getElementById("min_year_slider");e(2,F=t.value),console.log("updateMinYearFilter ",t.value,F),U()}async function U(){if(console.log("refreshAll begin",C,F),z){var t=document.getElementById("min_year_slider");t.defaultValue=F,t.value="1980",console.log("slider.defaultValue",t.value)}S=(await l.countriesPos.then((t=>t))).sort((function(t,n){return n.latitude-t.latitude}));for(var n={},v={},b=0;b<S.length;b++){var I=S[b],O=b%A.length;I.color=A[O],v[rt=I.name]=I.color,n[rt]=O}console.log("refreshAll ref_countries",S,v,n);var q=await l.bombusFreq.then((t=>t));0==m.length&&(m=q.map((t=>parseInt(t.Year))).filter(((t,n,e)=>e.indexOf(t)===n)).sort()),e(0,D=m[0]),e(1,Y=m[m.length-1]),console.log("refreshAll ",D,Y);var P=q.filter((function(t){return t.Year>=F}));for(b=0;b<P.length;b++){(I=P[b]).Year=1*I.Year,P[b]=I}y=m.filter((t=>t>=F)).sort(),console.log("refreshAll filtered_years",y);var V=P.map((t=>t.Country)).filter(((t,n,e)=>e.indexOf(t)===n)).sort();i=function(t){for(var n=0,e=0;e<t.length;e++)n+=1*t[e].Frequency;return n}(P);var B=pf(P,"Country",V,.01),R=(pf(P,"filtered_years",y,0),[]);for(var X in B)R.push(X);B.hasOwnProperty("Other")&&V.push("Other"),console.log("refreshAll allcountries_0",V,R),x=V.filter(((t,n,e)=>e.indexOf(t)===n&&R.includes(t))).sort();var G=[];for(b=0;b<V.length;b++)X=V[b],x.includes(X)||G.push(X);z&&(C=x),console.log("otherCountries",G),console.log("totalByCountries",i,B),console.log("allcountries",x),T=[],E={},N={};var W=0;W=0;for(b=0;b<x.length;b++){rt=x[b];var Z=A[W];E[rt]=Z,N["population_"+rt]=Z,++W>=A.length&&(W=0)}console.log("colors",T,E),console.log("countryFilter",C),console.log("mapColors",E),console.log("mapKeyColors",N),w=await l.speciesData.then((t=>t)),console.log("allcountries",x),_=x.filter((t=>C.includes(t))),console.log("countries",_);var K=function(t,n,e,r,i,o){console.log("agregateData2 dim2Others:",o);for(var a={},u=0;u<r.length;u++){a[h=r[u]]={};for(var l=0;l<i.length;l++){var s=i[l];a[h][s]=0}}for(var c=0;c<t.length;c++){var f=t[c],h=f[n];s=f[e],i.indexOf(s)>=0?a[h][s]=a[h][s]+1*f.Frequency:o.indexOf(s)>=0&&(a[h].Other=a[h].Other+1*f.Frequency)}return a}(P,"Year","Country",y,_,G),J=[];for(R=[],b=0;b<m.length;b++){var Q=y[b];if(Q>=F){for(var tt={year:Q,Total:0},nt=0;nt<_.length;nt++){var rt,it="population_"+(rt=_[nt]);tt[it]=K[Q][rt],tt.Total=tt.Total+K[Q][rt],_.indexOf(rt)>=0&&R.indexOf(it)<0&&R.push(it)}J.push(tt)}}var at=y.length;M=[];var ut=0;for(b=0;b<x.length;b++){var lt=B[rt=x[b]]/at;lt>ut&&(ut=lt),tt={country:rt,avg:lt,value:0,color:E[rt]},M.push(tt)}for(b=0;b<M.length;b++){(I=M[b]).value=1*I.avg/ut}L=await l.temperatures.then((t=>t)),j={};for(var st=0;st<y.length;st++){var ct=y[st],ft=L.filter((function(t){return t.Year==ct})),ht=0;for(nt=0;nt<ft.length;nt++){ht+=1*(I=ft[nt]).Temperature}lt=0,ft.length>0&&(lt=ht/ft.length),j[ct]=lt}console.log("temperatures_year",j),console.log("drawSelector selectorData",M,ut,at),async function(){if(void 0===a){var t=g+0*f+0*h;console.log("drawSelector svg_height",t),a=$n("#bubble_selector").append("svg").attr("id","svg_selector").attr("width",p+s+c).attr("height",t),a.append("g").attr("transform","translate("+s+","+f+")"),$n("body").append("div").attr("class","tooltip").style("opacity",0)}else $n("body").append("div").attr("class","tooltip").style("opacity",0),console.log("Nettoyage svg_selector"),a.selectAll("g").remove(),a.selectAll("circle").remove();var n=_u({children:M}).sum((function(t){return 1*t.value})).sort((function(t,n){return 100*n.value-100*t.value})),e=1;console.log("root",n,n.children);var r=0,i=[],o=[],u=0*f+.5*g+0,l=0,d=s,v=a.selectAll(".node").data($(n).leaves()).enter().append("g").attr("class","node");v.append("circle").attr("id",(function(t){return t.id})).attr("r",(function(t){var n=1*t.r;return r+=n,i.push(n),n})).style("stroke",(function(t){var n=t.data.country;return C.includes(n)?"#000":"grey"})).style("fill",(function(t){return t.data.color})).on("click",H);var m=i[0],y=(p-s-c)/2,_=.75*g/2;for(;e*m>_;)e-=.05;for(;e*r>y;)e-=.05;console.log("firstRadius1",m,"maxFirstRadius",_,"sumRadius1",r,"maxRumRadius",y,"radiusFactor",e),o=[],Un("circle").attr("r",(function(t){var n=1*e*t.r;return o.push(n),n})),console.log("listRadius",i,o),v.attr("transform",(function(t){return(l+=1)>1&&(d+=o[l-2]),"translate("+(d+=o[l-1])+","+u+")"}));v.append("svg:text").text((function(t){return t.data.country})).on("click",H).style("text-anchor","middle").style("fill",(function(t){var n=t.data.country;return C.includes(n)?"black":"grey"})).style("font-family","Arial").style("font-size","10px");var w=$n("#unselect_all");console.log("#unselect_all",w),$n("#unselect_all").on("click",(function(){console.log("handleSelectorReset"),C=[],U()})),$n("#select_all").on("click",(function(){console.log("handleSelectAll",x),C=x,U()})),console.log("end drawSelector")}(),function(t,n){console.log("drawHistoBars",n,_);var e=Ac().keys(n).order(bc).offset(xc);console.log("stack",e);var i=e(t);if(void 0===o){o=$n("#histo_chart").append("svg").attr("id","svg_histo").attr("width",p+s+c).attr("height",d+f+h).append("g").attr("transform","translate("+s+","+f+")");$n("body").append("div").attr("class","tooltip").style("opacity",0)}else console.log("Nettoyage"),o.selectAll("rect").remove(),o.selectAll("text").remove(),o.selectAll("line").remove();const a=Gu().domain(t.map((t=>t.year))).range([0,p]).padding(.1);console.log("series",i),r=et(i[i.length-1],(t=>t[1])),console.log("yMax",r);const l=al().domain([0,r]).range([d,0]);o.append("g").attr("transform","translate(0,"+d+")").call(gt(a).tickSize(0)).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-65)");let g=o.selectAll("g.countries").data(i).enter().append("g").style("fill",(function(t,n){return N.hasOwnProperty(t.key)?N[t.key]:"#ccc"}));o.append("g").call(vt(l).ticks(6));g.selectAll("rect").data((t=>t)).enter().append("rect").attr("x",(function(t){return a(t.data.year)})).attr("width",a.bandwidth()).attr("y",(function(t,n){return l(t[1])})).attr("height",(t=>d-l(t[1]-t[0])));for(var v=[],m=-1,w=-1,x=(y.length,0);x<y.length;x++){var b=y[x],M=j[b];if(w>0){var A={Year1:w,Value1:m,Year2:b,Value2:M};v.push(A)}w=b,m=M}const S=al().domain([5,15]).range([d,0]);for(x=0;x<v.length;x++){var E=v[x];if(E.Value1>0&&E.Value2>0){o.append("line").attr("x1",a(E.Year1)).attr("y1",S(E.Value1)).attr("x2",a(E.Year2)).attr("y2",S(E.Value2)).style("stroke","#000").style("stroke-width","0.5");if(4==x)o.append("text").attr("id","label_temperature").attr("x",a(E.Year1)).attr("y",S(.5+E.Value1)).text("Temperature").style("stroke","#000").style("stroke-width","0.5")}}!function(t,n){t.reverse();let e=n.reverse(),r=[];for(var i=0;i<e.length;i++){var a=e[i],l=N[a];r.push(l)}console.log("addLegend usedColors",r),void 0===u&&(u=o.append("g").attr("id","the_legend").attr("transform","translate(10, 20)"));u.selectAll("rect").remove(),u.selectAll("text").remove(),u.selectAll("line").remove(),u.selectAll().data(r).enter().append("rect").attr("height","20px").attr("width","20px").attr("x",5).attr("y",((t,n)=>n*hf)).style("fill",(t=>t)),u.selectAll().data(e).enter().append("text").attr("transform",((t,n)=>"translate(30, "+n*hf+")")).attr("dy",12.5).style("font-size","13px").style("fill","grey").text((t=>t.replaceAll("population_","")))}(T,n);let C=function(t){let n=ot(1,t+1),e=k/n.length;console.log("addTooltip values",n,t);var r=o.append("g").attr("id","tooltip").style("opacity",0);r.append("rect").attr("x",0).attr("y",0).attr("width",k).attr("height",80).style("opacity","0.9").style("fill","white").style("stroke-width","1").style("stroke","#929292").style("padding","1em"),r.append("line").attr("x1",40).attr("y1",25).attr("x2",160).attr("y2",25).style("stroke","#929292").style("stroke-width","0.5").attr("transform","translate(0, 5)");var i=r.append("text").style("font-size","13px").style("fill","grey").attr("transform","translate(0, 20)");return i.append("tspan").attr("x",525).attr("y",0).attr("id","tooltip-date").attr("text-anchor","middle").style("font-weight","600").style("font-size","16px"),i.selectAll("text.population").data(n).enter().append("tspan").attr("x",(n=>e/2+e*(1+t-n-1))).attr("y",30).attr("text-anchor","middle").style("fill","grey").text((t=>_[t-1])),i.selectAll("text.population").data(n).enter().append("tspan").attr("x",(n=>e/2+e*(1+t-n-1))).attr("y",45).attr("id",(t=>"tooltip-"+t)).attr("text-anchor","middle").style("fill","grey").style("font-size","0.8em").style("font-weight","bold"),r}(n.length);!function(t,n,e,i){let a=function(t,n,e){console.log("buildMousePolygon",t,n,e);const r=mc().x((t=>n.bandwidth()+n(t.year))).y((t=>e(t.value))).curve(wc);let i=[];for(let n=0;n<t.length;++n)i.push({year:t[n].year,value:t[n].Total});const o=(a="g",$n(Et(a).call(document.documentElement)));var a;o.append("path").datum(i).attr("d",r);let u="M "+n.bandwidth()+" "+e(t[0].Total)+" H 0 V "+d+" H "+p+" V "+e(t[t.length-1].Total);console.log("buildMousePolygon strPath ",u),o.append("path").attr("d",u);var l="";return o.selectAll("path").each((function(){l+=$n(this).attr("d")})),l}(t,n,e);o.append("path").attr("d",a).style("opacity",0).on("mouseover",(function(){i.style("opacity",1)})).on("mouseout",(function(){i.style("opacity",0)})).on("mousemove",(function(o,a){let u=In(o),l=Math.floor(u[0]/n.step()),s=t[l];if(void 0===s)return;let c=u[0]<525?0:u[0]>p-525?p-k:u[0]-525;i.attr("transform","translate("+c+","+(u[1]-90)+")"),e=(d-u[1])*r/d,i.select("#tooltip-date").text("Total "+s.year+" : "+s.Total);for(let t=0;t<_.length;t++){_[t];var f="population_"+_[t];s[f]>0&&i.select("#tooltip-"+(t+1)).text(s[f])}}))}(t,a,l,C)}(J,R),z=!1}function H(t,n){console.log("handleSelectorClick",n.data);var e=n.data.country;C.includes(e)?C=C.filter((t=>t!==e)):C.push(e),console.log("handleSelectorClick before refreshALL",C),U()}b((()=>U()));return t.$$set=t=>{"ripos"in t&&e(4,l=t.ripos)},[D,Y,F,I,l,()=>I()]}function gf(n){let e,r,i;return{c(){e=c("div"),e.innerHTML='<div id="race_chart"></div>',r=p(),i=c("input"),v(i,"id","bt_pause"),v(i,"class","bt_selector svelte-iotb72"),v(i,"type","button")},m(t,n){u(t,e,n),u(t,r,n),u(t,i,n)},p:t,i:t,o:t,d(t){t&&l(e),t&&l(r),t&&l(i)}}}var vf=2e3,mf=10,yf=600,_f=960;function wf(t){console.log("before kcreate svg");d3.select("#race_chart").append("svg").attr("width",960).attr("height",600);const n=80,e=0,r=5,i=2;let o=(yf-(r+n))/50,a=!1,u=1997;d3.csv("bombus_terrestris_freqs.csv").then((function(t){console.log(t);var s=d3.select("#race_chart").append("svg").attr("width",960).attr("height",600);s.append("text").attr("x",480).attr("y",35).attr("text-anchor","middle").style("fill","#5a5a5a").style("font-family","Raleway").style("font-weight","300").style("font-size","24px").html("Evolution of bees over time by country"),s.append("text").attr("class","subTitle").attr("y",55).html(""),s.append("text").attr("class","caption").attr("x",_f).attr("y",595).style("text-anchor","end").html("Source: Atlas Hymenoptera");var c=t.map((t=>parseInt(t.Year))).filter(((t,n,e)=>e.indexOf(t)===n)).sort(),f=t.map((t=>t.Country)).filter(((t,n,e)=>e.indexOf(t)===n)).sort(),h=function(t,n,e){for(var r={},i=0;i<n.length;i++){r[s=n[i]]={};for(var o=0;o<e.length;o++){var a=e[o];r[s][a]=0}}for(var u=0;u<t.length;u++){var l=t[u],s=l.Year;a=l.Country,e.indexOf(a)>=0&&(r[s][a]=r[s][a]+1*l.Frequency)}return r}(t,c,f);console.log(h);for(var p=[],d=0;d<c.length;d++){var g=c[d],v=h[g],m=Object.keys(v).map((function(t){return[t,v[t]]}));if(m.sort((function(t,n){return n[1]-t[1]})),g>=1890)for(var y=0;y<f.length;y++){var _=f[y],w={};w.name=_,w.value=h[g][_],w.year=g,h.hasOwnProperty(g-1)?w.lastValue=h[g-1][_]:w.lastValue=0;for(var x=0;x<m.length;x++)m[x][0]==_&&(w.rank=x);p.push(w)}}console.log(p),p.forEach((t=>{t.value=+t.value,t.lastValue=+t.lastValue,t.value=isNaN(t.value)?0:t.value,t.year=+t.year,t.colour=d3.hsl(360*Math.random(),.75,.75),d3.select("#bt_pause").on("click",(function(){var t=document.getElementById("bt_pause");a=!a,t.style.backgroundImage=a?"url(play.png)":"url(pause2.png)",t.style.backgroundRepeat="no-repeat",t.style.width="40px",t.style.height="40px",t.style.backgroundSize="40px"}))})),console.log(p);let b=p.filter((t=>t.year==u&&!isNaN(t.value))).sort(((t,n)=>n.value-t.value)).slice(0,mf);b.forEach(((t,n)=>t.rank=n)),console.log("yearSlice: ",b);let M=d3.scaleLinear().domain([0,d3.max(b,(t=>t.value))]).range([i,_f-e-65]),k=d3.scaleLinear().domain([mf,0]).range([yf-r,n]),A=d3.axisTop().scale(M).ticks(5).tickSize(-(yf-n-r)).tickFormat((t=>d3.format(",")(t)));s.append("g").attr("class","axis xAxis").attr("transform",`translate(0, ${n})`).call(A).selectAll(".tick line").classed("origin",(t=>0==t)),s.selectAll("rect.bar").data(b,(t=>t.name)).enter().append("rect").attr("class","bar").attr("x",M(0)+1).attr("width",(t=>M(t.value)-M(0)-1)).attr("y",(t=>k(t.rank)+5)).attr("height",k(1)-k(0)-o).style("fill",(t=>t.colour)),s.selectAll("text.label").data(b,(t=>t.name)).enter().append("text").attr("class","label").attr("x",(t=>M(t.value)-8)).attr("y",(t=>k(t.rank)+5+(k(1)-k(0))/2+1)).style("text-anchor","end").html((t=>t.name)),s.selectAll("text.valueLabel").data(b,(t=>t.name)).enter().append("text").attr("class","valueLabel").attr("x",(t=>M(t.value)+5)).attr("y",(t=>k(t.rank)+5+(k(1)-k(0))/2+1)).text((t=>d3.format(",.0f")(t.lastValue)));let S=s.append("text").attr("class","yearText").attr("x",_f-e).attr("y",575).style("text-anchor","end").style("font-size","4em").html(~~u).call(l,10),T=d3.interval((t=>{if(console.log("ticker CALL"),a)return void console.log("This is pause!");b=p.filter((t=>t.year==u&&!isNaN(t.value))).sort(((t,n)=>n.value-t.value)).slice(0,mf),b.forEach(((t,n)=>t.rank=n)),console.log("yearSlice: ",u,b),M.domain([0,d3.max(b,(t=>t.value))]),s.select(".xAxis").transition().duration(vf).ease(d3.easeLinear).call(A);let n=s.selectAll(".bar").data(b,(t=>t.name));n.enter().append("rect").attr("class",(t=>`bar ${t.name.replace(/\s/g,"_")}`)).attr("x",M(0)+1).attr("width",(t=>M(t.value)-M(0)-1)).attr("y",(t=>k(11)+5)).attr("height",k(1)-k(0)-o).style("fill",(t=>t.colour)).transition().duration(vf).ease(d3.easeLinear).attr("y",(t=>k(t.rank)+5)),n.transition().duration(vf).ease(d3.easeLinear).attr("width",(t=>M(t.value)-M(0)-1)).attr("y",(t=>k(t.rank)+5)),n.exit().transition().duration(vf).ease(d3.easeLinear).attr("width",(t=>M(t.value)-M(0)-1)).attr("y",(t=>k(11)+5)).remove();let e=s.selectAll(".label").data(b,(t=>t.name));e.enter().append("text").attr("class","label").attr("x",(t=>M(t.value)-8)).attr("y",(t=>k(11)+5+(k(1)-k(0))/2)).style("text-anchor","end").html((t=>t.name)).transition().duration(vf).ease(d3.easeLinear).attr("y",(t=>k(t.rank)+5+(k(1)-k(0))/2+1)),e.transition().duration(vf).ease(d3.easeLinear).attr("x",(t=>M(t.value)-8)).attr("y",(t=>k(t.rank)+5+(k(1)-k(0))/2+1)),e.exit().transition().duration(vf).ease(d3.easeLinear).attr("x",(t=>M(t.value)-8)).attr("y",(t=>k(11)+5)).remove();let r=s.selectAll(".valueLabel").data(b,(t=>t.name));r.enter().append("text").attr("class","valueLabel").attr("x",(t=>M(t.value)+5)).attr("y",(t=>k(11)+5)).text((t=>d3.format(",.0f")(t.lastValue))).transition().duration(vf).ease(d3.easeLinear).attr("y",(t=>k(t.rank)+5+(k(1)-k(0))/2+1)),r.transition().duration(vf).ease(d3.easeLinear).attr("x",(t=>M(t.value)+5)).attr("y",(t=>k(t.rank)+5+(k(1)-k(0))/2+1)).tween("text",(function(t){let n=d3.interpolateRound(t.lastValue,t.value);return function(t){this.textContent=d3.format(",")(n(t))}})),r.exit().transition().duration(vf).ease(d3.easeLinear).attr("x",(t=>M(t.value)+5)).attr("y",(t=>k(11)+5)).remove(),S.html(~~u),2010==u&&T.stop(),u=+u+1}),vf);var E=document.getElementById("bt_pause");E.style.backgroundImage="url(pause2.png)",E.style.backgroundRepeat="no-repeat",E.style.width="40px",E.style.height="40px",E.style.backgroundSize="40px"}));const l=function(t,n){t.select((function(){return this.parentNode.insertBefore(this.cloneNode(!0),this)})).style("fill","#ffffff").style("stroke","#ffffff").style("stroke-width",n).style("stroke-linejoin","round").style("opacity",1)};return[]}let xf={euGeoJson:Vi("/custom.geo.json"),euGeo2Json:Vi("/european-union-countries.json"),speciesData:Vi("/data_sources.json"),bombusFreq:qi("/bombus_terrestris_freqs.csv"),countriesPos:qi("/countries.csv"),temperatures:qi("/temperature.csv")};var bf=[{name:"Home",href:"/",component:class extends B{constructor(t){super(),V(this,t,Hc,Uc,o,{ripos:0})}},ripos:xf,navbar:!0},{name:"Geo Distribution",href:"/map",component:class extends B{constructor(t){super(),V(this,t,nf,Zc,o,{ripos:14},[-1,-1])}},ripos:xf,navbar:!0},{name:"Time evolution",href:"/TimeChart",component:class extends B{constructor(t){super(),V(this,t,df,ff,o,{ripos:4},[-1,-1])}},ripos:xf,navbar:!0},{name:"Evolution by Country",href:"/HorizontalChat",component:class extends B{constructor(t){super(),V(this,t,wf,gf,o,{})}},ripos:xf,navbar:!0},{name:"Frequency evolution",href:"/Graph",component:class extends B{constructor(t){super(),V(this,t,of,ef,o,{ripos:0})}},ripos:xf,navbar:!0},{name:"Chart evolution",href:"/GraphStart",component:class extends B{constructor(t){super(),V(this,t,cf,lf,o,{ripos:3})}},ripos:xf,navbar:!0}];function Mf(t,n,e){const r=t.slice();return r[3]=n[e],r}function kf(t,n,e){const r=t.slice();return r[3]=n[e],r}function Af(t){let n;function e(t,n){return t[1]=="#"+t[3].href?Tf:Sf}let r=e(t),i=r(t);return{c(){i.c(),n=d()},m(t,e){i.m(t,e),u(t,n,e)},p(t,o){r===(r=e(t))&&i?i.p(t,o):(i.d(1),i=r(t),i&&(i.c(),i.m(n.parentNode,n)))},d(t){i.d(t),t&&l(n)}}}function Sf(t){let n,e,r,i=t[3].name+"";return{c(){n=c("a"),e=h(i),v(n,"class","nav-link"),v(n,"href",r="#"+t[3].href)},m(t,r){u(t,n,r),a(n,e)},p(t,o){1&o&&i!==(i=t[3].name+"")&&m(e,i),1&o&&r!==(r="#"+t[3].href)&&v(n,"href",r)},d(t){t&&l(n)}}}function Tf(t){let n,e,r,i=t[3].name+"";return{c(){n=c("a"),e=h(i),v(n,"class","nav-link active"),v(n,"aria-current","page"),v(n,"href",r="#"+t[3].href)},m(t,r){u(t,n,r),a(n,e)},p(t,o){1&o&&i!==(i=t[3].name+"")&&m(e,i),1&o&&r!==(r="#"+t[3].href)&&v(n,"href",r)},d(t){t&&l(n)}}}function Ef(t){let n,e=t[3].navbar&&Af(t);return{c(){e&&e.c(),n=d()},m(t,r){e&&e.m(t,r),u(t,n,r)},p(t,r){t[3].navbar?e?e.p(t,r):(e=Af(t),e.c(),e.m(n.parentNode,n)):e&&(e.d(1),e=null)},d(t){e&&e.d(t),t&&l(n)}}}function Nf(t){let n,e,r;var i=t[3].component;function o(t){return{props:{ripos:t[3].ripos}}}return i&&(n=new i(o(t))),{c(){n&&H(n.$$.fragment),e=d()},m(t,i){n&&O(n,t,i),u(t,e,i),r=!0},p(t,r){const a={};if(1&r&&(a.ripos=t[3].ripos),i!==(i=t[3].component)){if(n){j();const t=n;U(t.$$.fragment,1,0,(()=>{q(t,1)})),$()}i?(n=new i(o(t)),H(n.$$.fragment),I(n.$$.fragment,1),O(n,e.parentNode,e)):n=null}else i&&n.$set(a)},i(t){r||(n&&I(n.$$.fragment,t),r=!0)},o(t){n&&U(n.$$.fragment,t),r=!1},d(t){t&&l(e),n&&q(n,t)}}}function Cf(t){let n,e,r=t[1]=="#"+t[3].href&&Nf(t);return{c(){r&&r.c(),n=d()},m(t,i){r&&r.m(t,i),u(t,n,i),e=!0},p(t,e){t[1]=="#"+t[3].href?r?(r.p(t,e),3&e&&I(r,1)):(r=Nf(t),r.c(),I(r,1),r.m(n.parentNode,n)):r&&(j(),U(r,1,1,(()=>{r=null})),$())},i(t){e||(I(r),e=!0)},o(t){U(r),e=!1},d(t){r&&r.d(t),t&&l(n)}}}function zf(t){let n,e,r,i,o,f,h,d,g,m,y,_=t[0],w=[];for(let n=0;n<_.length;n+=1)w[n]=Ef(kf(t,_,n));let x=t[0],b=[];for(let n=0;n<x.length;n+=1)b[n]=Cf(Mf(t,x,n));const M=t=>U(b[t],1,1,(()=>{b[t]=null}));return{c(){n=c("div"),e=c("nav"),r=c("div"),i=c("a"),i.textContent="Home",o=p(),f=c("button"),f.innerHTML='<span class="navbar-toggler-icon"></span>',h=p(),d=c("div"),g=c("div");for(let t=0;t<w.length;t+=1)w[t].c();m=p();for(let t=0;t<b.length;t+=1)b[t].c();v(i,"class","navbar-brand"),v(i,"href","#/"),v(f,"class","navbar-toggler"),v(f,"type","button"),v(f,"data-bs-toggle","collapse"),v(f,"data-bs-target","#navbarNavAltMarkup"),v(f,"aria-controls","navbarNavAltMarkup"),v(f,"aria-expanded","false"),v(f,"aria-label","Toggle navigation"),v(g,"class","navbar-nav"),v(d,"class","collapse navbar-collapse"),v(d,"id","navbarNavAltMarkup"),v(r,"class","container-fluid"),v(e,"class","navbar navbar-expand-lg navbar-light bg-light")},m(t,l){u(t,n,l),a(n,e),a(e,r),a(r,i),a(r,o),a(r,f),a(r,h),a(r,d),a(d,g);for(let t=0;t<w.length;t+=1)w[t].m(g,null);a(n,m);for(let t=0;t<b.length;t+=1)b[t].m(n,null);y=!0},p(t,[e]){if(3&e){let n;for(_=t[0],n=0;n<_.length;n+=1){const r=kf(t,_,n);w[n]?w[n].p(r,e):(w[n]=Ef(r),w[n].c(),w[n].m(g,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=_.length}if(3&e){let r;for(x=t[0],r=0;r<x.length;r+=1){const i=Mf(t,x,r);b[r]?(b[r].p(i,e),I(b[r],1)):(b[r]=Cf(i),b[r].c(),I(b[r],1),b[r].m(n,null))}for(j(),r=x.length;r<b.length;r+=1)M(r);$()}},i(t){if(!y){for(let t=0;t<x.length;t+=1)I(b[t]);y=!0}},o(t){b=b.filter(Boolean);for(let t=0;t<b.length;t+=1)U(b[t]);y=!1},d(t){t&&l(n),s(w,t),s(b,t)}}}function Df(t,n,e){let{routes:r}=n,i=()=>window.location.hash,o=i();return window.onhashchange=()=>e(1,o=i()),""==i()&&(window.location.href="/#/"),t.$$set=t=>{"routes"in t&&e(0,r=t.routes)},[r,o]}class Yf extends B{constructor(t){super(),V(this,t,Df,zf,o,{routes:0})}}function Ff(n){let e,r;return e=new Yf({props:{routes:bf}}),{c(){H(e.$$.fragment)},m(t,n){O(e,t,n),r=!0},p:t,i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){U(e.$$.fragment,t),r=!1},d(t){q(e,t)}}}return new class extends B{constructor(t){super(),V(this,t,null,Ff,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
